INFO:root:#Started running on job0
INFO:root:Job arguments : Namespace(RAxML_baseline_run_prefix='x', alternative_analysis=True, alternative_files_folder='../example_files', alternative_training=False, alternative_training_prefix='x', compare_lasso_to_naive=False, compare_loci_gene_distribution=False, compute_all_true_ll=False, compute_per_site_ll_values=False, const_brlen=False, curr_job_folder='../example_results/example_run/job_0', do_partitioned_lasso_analysis=False, do_raxml_lasso_nni_optimization=False, evo_model='WAG', exp_brlen=True, first_msa_ind=0, greedy_SPR=False, job_ind=0, jobs_prefix='example_run', lasso_baseline_run_prefix='x', lasso_thresholds='0.1_0.05_0.025_0.1', lasso_thresholds_search='0.05', loci_shift=0, logging_level='20', max_n_loci='1000', max_n_seq='10', min_n_loci=100, min_n_seq=7, msa_baseline_run_prefix='x', n_MSAs=1, n_cpus_Lasso=1, n_cpus_full=1, n_cpus_nni=2, n_cpus_per_job=1, n_cpus_training=1, n_jobs=1, n_nodes_Lasso=1, n_nodes_full=1, n_nodes_training=1, n_partitions=1, n_random_starting_trees=3, n_raxml_parsimony_trees=1, n_raxml_random_trees=1, no_test_set=False, only_evaluate_lasso=True, only_full_search=False, opt_brlen=False, optimized_neighbours_per_iter=-1, queue='pupkolab', random_lasso=False, random_trees_test_size=30, random_trees_training_size='800', rearr_dist=5, relaxed_lasso=False, run_prefix='example_run', run_raxml_commands_locally=False, search_epsilon='0.1', spr_baseline_run_prefix='x', start_of_starting_tree_ind=0, test_set_baseline_run_prefix='x', top_ind_to_test_per_phase='5_10', training_set_baseline_run_prefix='x', uni_brlen=False, use_glmnet_lasso=False, use_modified_final_search=False, use_parsimony_training_trees=False, use_raxml_search=False, use_raxml_standard_starting_trees=True, use_spr_neighbours_training=False, use_spr_parsimony_starting_tree=False)
INFO:root:#running on file name example_msa.phy and ind (relativ to job) 0  original path= ../example_files/example_msa.phy
INFO:root: Trimming MSA to n_seq = 10 n_loci = 1000
INFO:root:Generating msa stats from beggining
INFO:root:Original number of sequences is 33 and it will be trimmed to 10
Original number of loci's' is 1576 and it will be trimmed to 1000
INFO:root:obtained 10 sequences after 1 iterations!
INFO:root: 10 sequences written succesfully to new file ../example_results/example_run/job_0/example_msa.phy/n_seq_10/n_loci_1000/0.phy
INFO:numexpr.utils:NumExpr defaulting to 4 threads.
INFO:root:Basic MSA stats computed:
 {'n_seq': 10, 'MSA_original_n_seq': 33, 'n_seq_before_reduction_by_RaxML': 10, 'n_loci': 1000, 'MSA_original_n_loci': 1576, 'dataset_id': '../example_files/example_msa.phy', 'curr_msa_version_folder': '../example_results/example_run/job_0/example_msa.phy/n_seq_10/n_loci_1000', 'local_alignment_path': '../example_results/example_run/job_0/example_msa.phy/n_seq_10/n_loci_1000/0.phy', 'full_data_unique_name': '0', 'file_ind': 0, 'file_name': '0', 'file_type': '.phy', 'file_type_biopython': 'phylip-relaxed', 'constant_sites_pct': 0.567, 'avg_entropy': 0.3604690291333985, 'gap_pct': 0.5271999999999961, 'per_loci_partition': None, 'msa_orig_model_file': 'msa.raxml.model', 'msa_corrected_model_file': None, 'run_prefix': 'example_run', 'jobs_prefix': 'example_run', 'n_MSAs': 1, 'n_jobs': 1, 'first_msa_ind': 0, 'n_random_starting_trees': 3, 'random_trees_training_size': '800', 'exp_brlen': True, 'uni_brlen': False, 'opt_brlen': False, 'const_brlen': False, 'random_trees_test_size': 30, 'max_n_seq': '10', 'min_n_seq': 7, 'max_n_loci': '1000', 'min_n_loci': 100, 'only_evaluate_lasso': True, 'training_set_baseline_run_prefix': 'x', 'lasso_baseline_run_prefix': 'x', 'msa_baseline_run_prefix': 'x', 'spr_baseline_run_prefix': 'x', 'test_set_baseline_run_prefix': 'x', 'RAxML_baseline_run_prefix': 'x', 'alternative_training_prefix': 'x', 'evo_model': 'WAG', 'compare_lasso_to_naive': False, 'compare_loci_gene_distribution': False, 'do_partitioned_lasso_analysis': False, 'n_raxml_parsimony_trees': 1, 'n_raxml_random_trees': 1, 'use_raxml_standard_starting_trees': True, 'use_raxml_search': False, 'queue': 'pupkolab', 'do_raxml_lasso_nni_optimization': False, 'n_cpus_per_job': 1, 'n_cpus_full': 1, 'n_cpus_nni': 2, 'n_nodes_full': 1, 'n_cpus_Lasso': 1, 'n_nodes_Lasso': 1, 'n_cpus_training': 1, 'n_nodes_training': 1, 'alternative_files_folder': '../example_files', 'only_full_search': False, 'use_parsimony_training_trees': False, 'no_test_set': False, 'n_partitions': 1, 'lasso_thresholds': '0.1_0.05_0.025_0.1', 'lasso_thresholds_search': '0.05', 'run_raxml_commands_locally': False, 'random_lasso': False, 'alternative_training': False, 'use_glmnet_lasso': False, 'relaxed_lasso': False, 'use_spr_parsimony_starting_tree': False, 'compute_all_true_ll': False, 'compute_per_site_ll_values': False, 'top_ind_to_test_per_phase': '5_10', 'loci_shift': 0, 'rearr_dist': 5, 'optimized_neighbours_per_iter': -1, 'greedy_SPR': False, 'use_spr_neighbours_training': False, 'search_epsilon': '0.1', 'use_modified_final_search': False, 'start_of_starting_tree_ind': 0, 'logging_level': '20', 'job_ind': 0, 'curr_job_folder': '../example_results/example_run/job_0'}
INFO:root:Running RaxML statistics from full data and extracting statistics
ERROR:root:Could not generate rate4site output: command =   -bn -s ../example_results/example_run/job_0/example_msa.phy/n_seq_10/n_loci_1000/0.phy -t ../example_results/example_run/job_0/example_msa.phy/n_seq_10/n_loci_1000/raxml_full_data_results_0/0pars_eval.raxml.bestTree -o ../example_results/example_run/job_0/example_msa.phy/n_seq_10/n_loci_1000/r4s.res
INFO:root:Generating Lasso folder in ../example_results/example_run/job_0/example_msa.phy/n_seq_10/n_loci_1000/Lasso_folder
INFO:root:Generating Lasso results:
INFO:root: *Obtaining training data for brlen exponential:
INFO:root:Deleting dir content of ../example_results/example_run/job_0/example_msa.phy/n_seq_10/n_loci_1000/Lasso_folder/exponential/training_800_random_tree_eval/raxml_training_per_site_ll_eval
INFO:root:  **Applying Lasso for various alphas on current trimmed training data of size: 800
ERROR:root:Failed to get Lasso rate4site scores: 'rate4site_scores'
INFO:root:   ***Unified results for threshold : 0.1 are: 
 {'number_loci_chosen': 204, 'sample_pct': 0.204, 'weights_file_path': '../example_results/example_run/job_0/example_msa.phy/n_seq_10/n_loci_1000/Lasso_folder/exponential/training_800_random_tree_eval/trimmed_800/threshold_0.1_outputs/0_weights_t_0.1.txt', 'lambds': [2.296326437263358, 2.296326437263358], 'sampled_alignment_path': '../example_results/example_run/job_0/example_msa.phy/n_seq_10/n_loci_1000/Lasso_folder/exponential/training_800_random_tree_eval/trimmed_800/threshold_0.1_outputs/0_sampled_t_0.1.phy', 'lasso_intercept': -26470.946616294932, 'lasso_running_time': 17.037189960479736, 'lasso_threshold': 0.1, 'lasso_constant_sites_pct': 0.10784313725490197, 'lasso_avg_entropy': 1.0369137749788027, 'lasso_gap_positions_pct': 0.1343137254901961, 'lasso_mean_rate4site': -1.0, 'lasso_test_R^2': 0.9728120873496934, 'lasso_test_mse': 59258732.030609295, 'lasso_test_spearmanr': 0.9724137931034482, 'lasso_test_R^2_no_opt': 0.9836280379590928, 'lasso_test_mse_no_opt': 59998987.78573589, 'lasso_test_spearmanr_no_opt': 0.9830923248053391}
ERROR:root:Failed to get Lasso rate4site scores: 'rate4site_scores'
INFO:root:   ***Unified results for threshold : 0.05 are: 
 {'number_loci_chosen': 55, 'sample_pct': 0.055, 'weights_file_path': '../example_results/example_run/job_0/example_msa.phy/n_seq_10/n_loci_1000/Lasso_folder/exponential/training_800_random_tree_eval/trimmed_800/threshold_0.05_outputs/0_weights_t_0.05.txt', 'lambds': [6.09924459567269], 'sampled_alignment_path': '../example_results/example_run/job_0/example_msa.phy/n_seq_10/n_loci_1000/Lasso_folder/exponential/training_800_random_tree_eval/trimmed_800/threshold_0.05_outputs/0_sampled_t_0.05.phy', 'lasso_intercept': -22152.706293859428, 'lasso_running_time': 8.518594980239868, 'lasso_threshold': 0.05, 'lasso_constant_sites_pct': 0.05454545454545454, 'lasso_avg_entropy': 1.1602548161824269, 'lasso_gap_positions_pct': 0.09636363636363636, 'lasso_mean_rate4site': -1.0, 'lasso_test_R^2': 0.8514661628298789, 'lasso_test_mse': 61069.579372364446, 'lasso_test_spearmanr': 0.9061179087875416, 'lasso_test_R^2_no_opt': 0.9438394445813358, 'lasso_test_mse_no_opt': 27370.07073623061, 'lasso_test_spearmanr_no_opt': 0.9345939933259176}
ERROR:root:Failed to get Lasso rate4site scores: 'rate4site_scores'
INFO:root:   ***Unified results for threshold : 0.025 are: 
 {'number_loci_chosen': 27, 'sample_pct': 0.027, 'weights_file_path': '../example_results/example_run/job_0/example_msa.phy/n_seq_10/n_loci_1000/Lasso_folder/exponential/training_800_random_tree_eval/trimmed_800/threshold_0.025_outputs/0_weights_t_0.025.txt', 'lambds': [19.06450550381944], 'sampled_alignment_path': '../example_results/example_run/job_0/example_msa.phy/n_seq_10/n_loci_1000/Lasso_folder/exponential/training_800_random_tree_eval/trimmed_800/threshold_0.025_outputs/0_sampled_t_0.025.phy', 'lasso_intercept': -35397.699644587105, 'lasso_running_time': 8.518594980239868, 'lasso_threshold': 0.025, 'lasso_constant_sites_pct': 0.1111111111111111, 'lasso_avg_entropy': 1.1902070769701831, 'lasso_gap_positions_pct': 0.10740740740740741, 'lasso_mean_rate4site': -1.0, 'lasso_test_R^2': 0.7035170450058829, 'lasso_test_mse': 53574.91581664594, 'lasso_test_spearmanr': 0.7397107897664071, 'lasso_test_R^2_no_opt': 0.8995612723215878, 'lasso_test_mse_no_opt': 6168.828621642903, 'lasso_test_spearmanr_no_opt': 0.9092324805339266}
ERROR:root:Failed to get Lasso rate4site scores: 'rate4site_scores'
INFO:root:   ***Unified results for threshold : 0.1 are: 
 {'number_loci_chosen': 204, 'sample_pct': 0.204, 'weights_file_path': '../example_results/example_run/job_0/example_msa.phy/n_seq_10/n_loci_1000/Lasso_folder/exponential/training_800_random_tree_eval/trimmed_800/threshold_0.1_outputs/0_weights_t_0.1.txt', 'lambds': [2.296326437263358, 2.296326437263358], 'sampled_alignment_path': '../example_results/example_run/job_0/example_msa.phy/n_seq_10/n_loci_1000/Lasso_folder/exponential/training_800_random_tree_eval/trimmed_800/threshold_0.1_outputs/0_sampled_t_0.1.phy', 'lasso_intercept': -26470.946616294932, 'lasso_running_time': 17.037189960479736, 'lasso_threshold': 0.1, 'lasso_constant_sites_pct': 0.10784313725490197, 'lasso_avg_entropy': 1.0369137749788027, 'lasso_gap_positions_pct': 0.1343137254901961, 'lasso_mean_rate4site': -1.0, 'lasso_test_R^2': 0.9728120873496934, 'lasso_test_mse': 59258732.030609295, 'lasso_test_spearmanr': 0.9724137931034482, 'lasso_test_R^2_no_opt': 0.9836280379590928, 'lasso_test_mse_no_opt': 59998987.78573589, 'lasso_test_spearmanr_no_opt': 0.9830923248053391}
INFO:root:only evaluating lasso on brlen exponential and training size 800: 
INFO:root:only evaluating lasso on brlen exponential and training size 800: 
INFO:root:only evaluating lasso on brlen exponential and training size 800: 
