full_r4s<- read_csv("/Users/noa/Workspace/lasso_positions_sampling_results/ShenA9_full_rate4site")
lasso_r4s<- read_csv("/Users/noa/Workspace/lasso_positions_sampling_results/ShenA9_lasso_rate4site")
full_r4s<- full_r4s %>% mutate(data = "All MSA positions")
full_r4s
lasso_r4s<- lasso_r4s %>% mutate(data = "Positions chosen by Lasso")
lasso_r4s
all_r4s_data_shen<-rbind(full_r4s,lasso_r4s)  %>% mutate(dataset="ShenA9")
all_r4s_data_shen %>% ggplot(aes(x = Numbers, fill = data)) +
geom_histogram(bins=8,aes(y=..density..),
alpha=0.5,position='identity',binwidth=0.5) + labs(fill = "Positions", x = "Standartaized rates", y= "Density")
summary(lasso_r4s %>% pull(Numbers))
ttest<-t.test(lasso_r4s %>% pull(Numbers),full_r4s%>%pull(Numbers))
full_r4s<- read_csv("/Users/noa/Workspace/lasso_positions_sampling_results/MisoA2_full_rate4site")
lasso_r4s<- read_csv("/Users/noa/Workspace/lasso_positions_sampling_results/MisoA2_lasso_rate4site")
full_r4s<- full_r4s %>% mutate(data = "All MSA positions")
full_r4s
lasso_r4s<- lasso_r4s %>% mutate(data = "Positions chosen by Lasso")
lasso_r4s
all_r4s_data<-rbind(full_r4s,lasso_r4s) %>% mutate(dataset="MisoA2")
all_r4s_data_miso
full_r4s<- read_csv("/Users/noa/Workspace/lasso_positions_sampling_results/MisoA2_full_rate4site")
lasso_r4s<- read_csv("/Users/noa/Workspace/lasso_positions_sampling_results/MisoA2_lasso_rate4site")
full_r4s<- full_r4s %>% mutate(data = "All MSA positions")
full_r4s
lasso_r4s<- lasso_r4s %>% mutate(data = "Positions chosen by Lasso")
lasso_r4s
all_r4s_data_miso<-rbind(full_r4s,lasso_r4s) %>% mutate(dataset="MisoA2")
all_r4s_data_miso
all_r4s_data_miso %>% ggplot(aes(x = Numbers, fill = data)) +
geom_histogram(bins=8,aes(y=..density..),
alpha=0.5,position='identity',binwidth=0.5) + labs(fill = "Positions", x = "Standartaized rates", y= "Density")
summary(lasso_r4s %>% pull(Numbers))
ttest<-t.test(lasso_r4s %>% pull(Numbers),full_r4s%>%pull(Numbers))
supp_data2<- new_format_lasso_data %>% select(dataset_name,actual_n_seq, actual_n_loci,actual_training_size, actual_sample_pct, number_loci_chosen ,`lasso_test_R^2`) %>% arrange(dataset_name)
supp_data2 %>% write_csv("/Users/noa/Workspace/lasso_positions_sampling_results/supp2.csv")
new_format_lasso_data  %>%  mutate (unexplained_var = 1-`lasso_test_R^2`) %>%
filter (actual_n_loci==80000, actual_n_seq==15) %>%
ggplot(aes(x=actual_sample_pct,y=unexplained_var, group = interaction(actual_training_size,dataset_name), color = as.factor(actual_training_size)))+ geom_line() + geom_point(size=1.5) + scale_x_continuous(labels = scales::percent,breaks = c(0.01,0.025,0.05,0.1)) +labs(color="Training size" ,x="Sample percentage",y="Unexplained variance on test set (%)") + theme_classic()+facet_grid(cols = vars(dataset_name)) + theme(axis.text.x = element_text(angle = 60, vjust = 0.9, hjust=1))
new_format_lasso_data  %>%  mutate (unexplained_var = 1-`lasso_test_R^2`) %>%
filter (actual_n_loci==80000, actual_n_seq==15) %>%
ggplot(aes(x=actual_sample_pct,y=unexplained_var, group = interaction(actual_training_size,dataset_name), color = as.factor(actual_training_size)))+ geom_line() + geom_point(size=1.5) + scale_x_continuous(labels = scales::percent,breaks = c(0.01,0.025,0.05,0.1)) +labs(color="Training size" ,x="Sample percentage",y="Unexplained variance on test set (%)") + theme_classic()+facet_grid(cols = vars(dataset_name)) + theme(axis.text.x = element_text(angle = 60, vjust = 0.9, hjust=1))
new_format_lasso_data  %>%  mutate (unexplained_var = 1-`lasso_test_R^2`) %>%
filter (actual_n_loci==80000, actual_n_seq==30) %>%
ggplot(aes(x=actual_sample_pct,y=unexplained_var, group = interaction(actual_training_size,dataset_name), color = as.factor(actual_training_size)))+ geom_line() + geom_point(size=1.5) + scale_x_continuous(labels = scales::percent,breaks = c(0.01,0.025,0.05,0.1)) +labs(color="Training size" ,x="Sample percentage",y="Unexplained variance on test set (%)") + theme_classic()+facet_grid(cols = vars(dataset_name)) + theme(axis.text.x = element_text(angle = 60, vjust = 0.9, hjust=1))
new_format_lasso_data  %>%  mutate (unexplained_var = 1-`lasso_test_R^2`) %>%
filter (actual_n_loci==80000, actual_n_seq==60) %>%
ggplot(aes(x=actual_sample_pct,y=unexplained_var, group = interaction(actual_training_size,dataset_name), color = as.factor(actual_training_size)))+ geom_line() + geom_point(size=1.5) + scale_x_continuous(labels = scales::percent,breaks = c(0.01,0.025,0.05,0.1)) +labs(color="Training size" ,x="Sample percentage",y="Unexplained variance on test set (%)") + theme_classic()+facet_grid(cols = vars(dataset_name)) + theme(axis.text.x = element_text(angle = 60, vjust = 0.9, hjust=1))
supp_data2<- new_format_lasso_data %>% select(dataset_name,actual_n_seq, actual_n_loci,actual_training_size, actual_sample_pct, number_loci_chosen ,`lasso_test_R^2`) %>% arrange(dataset_name)
supp_data2 %>% write_csv("/Users/noa/Workspace/lasso_positions_sampling_results/supp2.csv")
new_format_lasso_data  %>%  mutate (unexplained_var = 1-`lasso_test_R^2`) %>%
filter (actual_n_loci==80000) %>%
ggplot(aes(x=actual_sample_pct,y=unexplained_var, group = interaction(actual_training_size,dataset_name), color = as.factor(actual_training_size)))+ geom_line() + geom_point(size=1.5) + scale_x_continuous(labels = scales::percent,breaks = c(0.01,0.025,0.05,0.1)) +labs(color="Training size" ,x="Sample percentage",y="Unexplained variance on test set (%)") + theme_classic()+facet_grid(cols = vars(dataset_name), rows=  vars(actual_n_seq)) + theme(axis.text.x = element_text(angle = 60, vjust = 0.9, hjust=1))
new_format_lasso_data  %>%  mutate (unexplained_var = 1-`lasso_test_R^2`) %>%
filter (actual_n_loci==80000, dataset_name %in% c("MisoA2","NagyA1","ShenA9")) %>%
ggplot(aes(x=actual_sample_pct,y=unexplained_var, group = interaction(actual_training_size,dataset_name), color = as.factor(actual_training_size)))+ geom_line() + geom_point(size=1.5) + scale_x_continuous(labels = scales::percent,breaks = c(0.01,0.025,0.05,0.1)) +labs(color="Training size" ,x="Sample percentage",y="Unexplained variance on test set (%)") + theme_classic()+facet_grid(cols = vars(dataset_name), rows=  vars(actual_n_seq)) + theme(axis.text.x = element_text(angle = 60, vjust = 0.9, hjust=1))
new_format_lasso_data  %>%  mutate (unexplained_var = 1-`lasso_test_R^2`) %>%
filter (actual_n_loci==80000, dataset_name %in% c("MisoA2","NagyA1","ShenA9")) %>%
ggplot(aes(x=actual_sample_pct,y=unexplained_var, group = interaction(actual_training_size,dataset_name), color = as.factor(actual_training_size)))+ geom_line() + geom_point(size=1.5) + scale_x_continuous(labels = scales::percent,breaks = c(0.01,0.025,0.05,0.1)) +labs(color="Training size" ,x="Sample percentage",y="Unexplained variance on test set (%)") + theme_classic()+facet_grid(rows = vars(dataset_name), cols=  vars(actual_n_seq)) + theme(axis.text.x = element_text(angle = 60, vjust = 0.9, hjust=1))
new_format_lasso_data  %>%  mutate (unexplained_var = 1-`lasso_test_R^2`) %>%
filter (actual_n_loci==80000, dataset_name %in% c("MisoA2","NagyA1","ShenA9")) %>%
ggplot(aes(x=actual_sample_pct,y=unexplained_var, group = interaction(actual_training_size,dataset_name), color = as.factor(actual_training_size)))+ geom_line() + geom_point(size=1.5) + scale_x_continuous(labels = scales::percent,breaks = c(0.01,0.025,0.05,0.1)) +labs(color="Training size" ,x="Sample percentage",y="Unexplained variance on test set (%)") + theme_classic()+facet_grid(cols = vars(dataset_name), rows=  vars(actual_n_seq)) + theme(axis.text.x = element_text(angle = 60, vjust = 0.9, hjust=1))
new_format_lasso_data  %>%  mutate (unexplained_var = 1-`lasso_test_R^2`) %>%
filter (actual_n_loci==80000, dataset_name %in% c("MisoA2","NagyA1","ShenA9")) %>%
ggplot(aes(x=actual_sample_pct,y=unexplained_var, group = interaction(actual_training_size,dataset_name), color = as.factor(actual_training_size)))+ geom_line() + geom_point(size=1.5) + scale_x_continuous(labels = scales::percent,breaks = c(0.01,0.025,0.05,0.1)) +labs(color="Training size" ,x="Sample percentage",y="Unexplained variance on test set (%)") + theme_classic()+facet_grid(cols = vars(dataset_name), rows=  vars(actual_n_seq)) + theme(axis.text.x = element_text(angle = 60, vjust = 0.9, hjust=1))
new_format_lasso_data  %>%  mutate (unexplained_var = 1-`lasso_test_R^2`) %>%
filter (actual_n_loci==80000, dataset_name %in% c("YangA8","StruA5","WickA3")) %>%
ggplot(aes(x=actual_sample_pct,y=unexplained_var, group = interaction(actual_training_size,dataset_name), color = as.factor(actual_training_size)))+ geom_line() + geom_point(size=1.5) + scale_x_continuous(labels = scales::percent,breaks = c(0.01,0.025,0.05,0.1)) +labs(color="Training size" ,x="Sample percentage",y="Unexplained variance on test set (%)") + theme_classic()+facet_grid(cols = vars(dataset_name), rows=  vars(actual_n_seq)) + theme(axis.text.x = element_text(angle = 60, vjust = 0.9, hjust=1))
new_format_lasso_data  %>%  mutate (unexplained_var = 1-`lasso_test_R^2`) %>%
filter (actual_n_loci==40000, dataset_name %in% c("MisoA2","NagyA1","ShenA9")) %>%
ggplot(aes(x=actual_sample_pct,y=unexplained_var, group = interaction(actual_training_size,dataset_name), color = as.factor(actual_training_size)))+ geom_line() + geom_point(size=1.5) + scale_x_continuous(labels = scales::percent,breaks = c(0.01,0.025,0.05,0.1)) +labs(color="Training size" ,x="Sample percentage",y="Unexplained variance on test set (%)") + theme_classic()+facet_grid(cols = vars(dataset_name), rows=  vars(actual_n_seq)) + theme(axis.text.x = element_text(angle = 60, vjust = 0.9, hjust=1))
new_format_lasso_data  %>%  mutate (unexplained_var = 1-`lasso_test_R^2`) %>%
filter (actual_n_loci==40000, dataset_name %in% c("YangA8","StruA5","WickA3")) %>%
ggplot(aes(x=actual_sample_pct,y=unexplained_var, group = interaction(actual_training_size,dataset_name), color = as.factor(actual_training_size)))+ geom_line() + geom_point(size=1.5) + scale_x_continuous(labels = scales::percent,breaks = c(0.01,0.025,0.05,0.1)) +labs(color="Training size" ,x="Sample percentage",y="Unexplained variance on test set (%)") + theme_classic()+facet_grid(cols = vars(dataset_name), rows=  vars(actual_n_seq)) + theme(axis.text.x = element_text(angle = 60, vjust = 0.9, hjust=1))
new_format_lasso_data  %>%  mutate (unexplained_var = 1-`lasso_test_R^2`) %>%
filter (actual_n_loci==20000, dataset_name %in% c("MisoA2","NagyA1","ShenA9")) %>%
ggplot(aes(x=actual_sample_pct,y=unexplained_var, group = interaction(actual_training_size,dataset_name), color = as.factor(actual_training_size)))+ geom_line() + geom_point(size=1.5) + scale_x_continuous(labels = scales::percent,breaks = c(0.01,0.025,0.05,0.1)) +labs(color="Training size" ,x="Sample percentage",y="Unexplained variance on test set (%)") + theme_classic()+facet_grid(cols = vars(dataset_name), rows=  vars(actual_n_seq)) + theme(axis.text.x = element_text(angle = 60, vjust = 0.9, hjust=1))
new_format_lasso_data  %>%  mutate (unexplained_var = 1-`lasso_test_R^2`) %>%
filter (actual_n_loci==20000, dataset_name %in% c("YangA8","StruA5","WickA3")) %>%
ggplot(aes(x=actual_sample_pct,y=unexplained_var, group = interaction(actual_training_size,dataset_name), color = as.factor(actual_training_size)))+ geom_line() + geom_point(size=1.5) + scale_x_continuous(labels = scales::percent,breaks = c(0.01,0.025,0.05,0.1)) +labs(color="Training size" ,x="Sample percentage",y="Unexplained variance on test set (%)") + theme_classic()+facet_grid(cols = vars(dataset_name), rows=  vars(actual_n_seq)) + theme(axis.text.x = element_text(angle = 60, vjust = 0.9, hjust=1))
12210.645+4291.757438
16502.40244/10
16502+10*6,208
16502+10*6208
133,818*10
133818*10
1338180/78582
supp_data4<-  all_msa_running_time
supp_data4 %>% write_csv("/Users/noa/Workspace/lasso_positions_sampling_results/supp4.csv")
n_cores_full =15
n_cores_lasso = 1
n_starting_trees = 3
# running_time_analysis
all_msa_running_time<-spr_data_edited %>% select (dataset_name,`lasso_test_R^2_phase_0`,naive_SPR_SPR_ll, final_phase_SPR_ll,
phase_0_SPR_ll,
naive_SPR_spr_moves,phase_0_spr_moves,final_phase_spr_moves,   delta_ll_phase_0,  lasso_ll_vs_max , naive_vs_max,                                             sample_pct_phase_0,starting_tree_id,delta_ll_final,actual_n_seq,naive_SPR_no_brlen_running_time,naive_SPR_brlen_running_time, phase_0_no_brlen_running_time, phase_0_brlen_running_time,final_phase_no_brlen_running_time, final_phase_brlen_running_time, full_size_training_evaluation_time_phase_0, lasso_running_time_phase_0,lasso_training_size_phase_0,phase_0_total_spr_neighbours_evaluated,phase_0_total_spr_neighbours_optimized,
final_phase_total_spr_neighbours_evaluated,final_phase_total_spr_neighbours_optimized,naive_SPR_total_spr_neighbours_evaluated,naive_SPR_total_spr_neighbours_optimized) %>% mutate (run_time_naive = n_cores_full*(naive_SPR_no_brlen_running_time+naive_SPR_brlen_running_time), n_evals_naive = naive_SPR_total_spr_neighbours_evaluated, n_opts_naive =  naive_SPR_total_spr_neighbours_optimized,
run_time_lasso = n_cores_lasso*(phase_0_no_brlen_running_time+phase_0_brlen_running_time) + (n_cores_lasso*final_phase_no_brlen_running_time)+(n_cores_full*final_phase_brlen_running_time), n_evals_lasso =sample_pct_phase_0*(phase_0_total_spr_neighbours_evaluated+final_phase_total_spr_neighbours_evaluated) ,
n_opts_lasso =  phase_0_total_spr_neighbours_optimized*sample_pct_phase_0+final_phase_total_spr_neighbours_optimized,                                                                                                                                           run_time_training = full_size_training_evaluation_time_phase_0* n_cores_full, n_evals_training =lasso_training_size_phase_0 , run_time_lasso_algorithm =lasso_running_time_phase_0  ) %>% mutate(
ratio_including_training =run_time_naive/(run_time_lasso+((run_time_training+run_time_lasso_algorithm)/n_starting_trees
)) , ratio_without_training =run_time_naive/run_time_lasso,
opt_operations_ratio =n_opts_naive/n_opts_lasso,
eval_operations_ratio_no_training = n_evals_naive/(n_evals_lasso),
eval_operations_ratio =n_evals_naive/(n_evals_lasso+lasso_training_size_phase_0/n_starting_trees),
pct_eval_final_phase = final_phase_total_spr_neighbours_evaluated/(phase_0_total_spr_neighbours_evaluated+final_phase_total_spr_neighbours_evaluated),
spr_moves_ratio = naive_SPR_spr_moves/(phase_0_spr_moves+final_phase_spr_moves)
)
all_msa_running_time_pretty<-all_msa_running_time %>% select (dataset_name, actual_n_seq,run_time_naive,run_time_lasso, run_time_lasso_algorithm, run_time_training,
ratio_without_training,ratio_including_training,
n_opts_naive, n_opts_lasso,  n_evals_naive, n_evals_lasso, lasso_training_size_phase_0,opt_operations_ratio,eval_operations_ratio,eval_operations_ratio_no_training,pct_eval_final_phase,
) %>% arrange(dataset_name, actual_n_seq)
theme_set(theme_bw(12))
excluding_training_phase<-all_msa_running_time %>% ggplot(aes(x=ratio_without_training, y=delta_ll_final, color = dataset_name,)) + geom_point(size = 3) + facet_grid(rows = vars(actual_n_seq)) + theme(axis.text.x = element_text(angle = 60, vjust = 0.9, hjust=1))+
labs(color = "Empirical MSA",x="Running-time decrease factor\n excluding training phase",y="Delta LL") + geom_hline(yintercept=0, linetype="dashed", color = "red")
including_training_phase<-all_msa_running_time %>% ggplot(aes(x=ratio_including_training,y=delta_ll_final, color = dataset_name)) + geom_point(size =3) + facet_grid(rows = vars(actual_n_seq))   + theme(axis.text.x = element_text(angle = 60, vjust = 0.9, hjust=1))+
labs(color = "Empirical MSA",x="Running-time decrease factor\n including training phase",y="Delta LL")+ geom_hline(yintercept=0, linetype="dashed", color = "red")
including_training_phase<-all_msa_running_time %>% ggplot(aes(x=ratio_including_training,y=delta_ll_final, color = dataset_name)) + geom_point(size =3) + facet_grid(rows = vars(actual_n_seq))   + theme(axis.text.x = element_text(angle = 60, vjust = 0.9, hjust=1))+
labs(color = "Empirical MSA",x="Running-time decrease factor\n including training phase",y="Delta LL")+ geom_hline(yintercept=0, linetype="dashed", color = "red")
n_cores_full =15
n_cores_lasso = 1
n_starting_trees = 3
# running_time_analysis
all_msa_running_time<-spr_data_edited %>% select (dataset_name,`lasso_test_R^2_phase_0`,naive_SPR_SPR_ll, final_phase_SPR_ll,
phase_0_SPR_ll,
naive_SPR_spr_moves,phase_0_spr_moves,final_phase_spr_moves,   delta_ll_phase_0,  lasso_ll_vs_max , naive_vs_max,                                             sample_pct_phase_0,starting_tree_id,delta_ll_final,actual_n_seq,naive_SPR_no_brlen_running_time,naive_SPR_brlen_running_time, phase_0_no_brlen_running_time, phase_0_brlen_running_time,final_phase_no_brlen_running_time, final_phase_brlen_running_time, full_size_training_evaluation_time_phase_0, lasso_running_time_phase_0,lasso_training_size_phase_0,phase_0_total_spr_neighbours_evaluated,phase_0_total_spr_neighbours_optimized,
final_phase_total_spr_neighbours_evaluated,final_phase_total_spr_neighbours_optimized,naive_SPR_total_spr_neighbours_evaluated,naive_SPR_total_spr_neighbours_optimized) %>% mutate (run_time_naive = n_cores_full*(naive_SPR_no_brlen_running_time+naive_SPR_brlen_running_time), n_evals_naive = naive_SPR_total_spr_neighbours_evaluated, n_opts_naive =  naive_SPR_total_spr_neighbours_optimized,
run_time_lasso_phase0 = n_cores_lasso*(phase_0_no_brlen_running_time+phase_0_brlen_running_time),
run_time_lasso_final_phase= (n_cores_lasso*final_phase_no_brlen_running_time)+(n_cores_full*final_phase_brlen_running_time),                                                                                                                      run_time_lasso =  run_time_lasso_phase0+run_time_lasso_final_phase
, n_evals_lasso =sample_pct_phase_0*(phase_0_total_spr_neighbours_evaluated+final_phase_total_spr_neighbours_evaluated) ,
n_opts_lasso =  phase_0_total_spr_neighbours_optimized*sample_pct_phase_0+final_phase_total_spr_neighbours_optimized,                                                                                                                                           run_time_training = full_size_training_evaluation_time_phase_0* n_cores_full, n_evals_training =lasso_training_size_phase_0 , run_time_lasso_algorithm =lasso_running_time_phase_0  ) %>% mutate(
ratio_including_training =run_time_naive/(run_time_lasso+((run_time_training+run_time_lasso_algorithm)/n_starting_trees
)) , ratio_without_training =run_time_naive/run_time_lasso,
opt_operations_ratio =n_opts_naive/n_opts_lasso,
eval_operations_ratio_no_training = n_evals_naive/(n_evals_lasso),
eval_operations_ratio =n_evals_naive/(n_evals_lasso+lasso_training_size_phase_0/n_starting_trees),
pct_eval_final_phase = final_phase_total_spr_neighbours_evaluated/(phase_0_total_spr_neighbours_evaluated+final_phase_total_spr_neighbours_evaluated),
spr_moves_ratio = naive_SPR_spr_moves/(phase_0_spr_moves+final_phase_spr_moves)
)
all_msa_running_time_pretty<-all_msa_running_time %>% select (dataset_name, actual_n_seq,run_time_naive,run_time_lasso, run_time_lasso_algorithm, run_time_training,
ratio_without_training,ratio_including_training,
n_opts_naive, n_opts_lasso,  n_evals_naive, n_evals_lasso, lasso_training_size_phase_0,opt_operations_ratio,eval_operations_ratio,eval_operations_ratio_no_training,pct_eval_final_phase,
) %>% arrange(dataset_name, actual_n_seq)
theme_set(theme_bw(12))
excluding_training_phase<-all_msa_running_time %>% ggplot(aes(x=ratio_without_training, y=delta_ll_final, color = dataset_name,)) + geom_point(size = 3) + facet_grid(rows = vars(actual_n_seq)) + theme(axis.text.x = element_text(angle = 60, vjust = 0.9, hjust=1))+
labs(color = "Empirical MSA",x="Running-time decrease factor\n excluding training phase",y="Delta LL") + geom_hline(yintercept=0, linetype="dashed", color = "red")
including_training_phase<-all_msa_running_time %>% ggplot(aes(x=ratio_including_training,y=delta_ll_final, color = dataset_name)) + geom_point(size =3) + facet_grid(rows = vars(actual_n_seq))   + theme(axis.text.x = element_text(angle = 60, vjust = 0.9, hjust=1))+
labs(color = "Empirical MSA",x="Running-time decrease factor\n including training phase",y="Delta LL")+ geom_hline(yintercept=0, linetype="dashed", color = "red")
including_training_phase<-all_msa_running_time %>% ggplot(aes(x=ratio_including_training,y=delta_ll_final, color = dataset_name)) + geom_point(size =3) + facet_grid(rows = vars(actual_n_seq))   + theme(axis.text.x = element_text(angle = 60, vjust = 0.9, hjust=1))+
labs(color = "Empirical MSA",x="Running-time decrease factor\n including training phase",y="Delta LL")+ geom_hline(yintercept=0, linetype="dashed", color = "red")
supp_data4<-  all_msa_running_time  %>% select (naive_SPR_SPR_ll,naive_SPR_spr_moves,run_time_naive, phase_0_SPR_ll,phase_0_spr_moves,run_time_lasso_phase_0,final_phase_spr_moves,final_phase_SPR_ll,run_time_lasso_final_phase)
supp_data4<-  all_msa_running_time  %>% select (naive_SPR_SPR_ll,naive_SPR_spr_moves,run_time_naive, phase_0_SPR_ll,phase_0_spr_moves,run_time_lasso_phase0,final_phase_spr_moves,final_phase_SPR_ll,run_time_lasso_final_phase)
supp_data4
supp_data4 %>% write_csv("/Users/noa/Workspace/lasso_positions_sampling_results/supp4.csv")
supp_data4<-  all_msa_running_time  %>% select (dataset_name, starting_tree_ind,naive_SPR_SPR_ll,naive_SPR_spr_moves,run_time_naive, phase_0_SPR_ll,phase_0_spr_moves,run_time_lasso_phase0,final_phase_spr_moves,final_phase_SPR_ll,run_time_lasso_final_phase)
supp_data4<-  all_msa_running_time  %>% select (dataset_name, starting_tree_id,naive_SPR_SPR_ll,naive_SPR_spr_moves,run_time_naive, phase_0_SPR_ll,phase_0_spr_moves,run_time_lasso_phase0,final_phase_spr_moves,final_phase_SPR_ll,run_time_lasso_final_phase)
supp_data4
supp_data4 %>% write_csv("/Users/noa/Workspace/lasso_positions_sampling_results/supp4.csv")
supp_data4<-  all_msa_running_time  %>% select (dataset_name,actual_n_seq, starting_tree_id,naive_SPR_SPR_ll,naive_SPR_spr_moves,run_time_naive, phase_0_SPR_ll,phase_0_spr_moves,run_time_lasso_phase0,final_phase_spr_moves,final_phase_SPR_ll,run_time_lasso_final_phase)
supp_data4
supp_data4 %>% write_csv("/Users/noa/Workspace/lasso_positions_sampling_results/supp4.csv")
supp_data4<-  all_msa_running_time  %>% select (dataset_name,actual_n_seq, starting_tree_id,naive_SPR_SPR_ll,naive_SPR_spr_moves,run_time_naive, phase_0_SPR_ll,phase_0_spr_moves,run_time_lasso_phase0,final_phase_spr_moves,final_phase_SPR_ll,run_time_lasso_final_phase)
supp_data4
supp_data4 %>% filter (dataset_name="NagyA1")
supp_data4<-  all_msa_running_time  %>% select (dataset_name,actual_n_seq, starting_tree_id,naive_SPR_SPR_ll,naive_SPR_spr_moves,run_time_naive, phase_0_SPR_ll,phase_0_spr_moves,run_time_lasso_phase0,final_phase_spr_moves,final_phase_SPR_ll,run_time_lasso_final_phase)
supp_data4
supp_data4 %>% filter (dataset_name=="NagyA1")
supp_data4 %>% write_csv("/Users/noa/Workspace/lasso_positions_sampling_results/supp4.csv")
supp_data4<-  all_msa_running_time  %>% select (dataset_name,actual_n_seq, starting_tree_id,naive_SPR_SPR_ll,naive_SPR_spr_moves,run_time_naive, phase_0_SPR_ll,phase_0_spr_moves,run_time_lasso_phase0,final_phase_spr_moves,final_phase_SPR_ll,run_time_lasso_final_phase)
supp_data4
supp_data4 %>% filter (dataset_name=="NagyA1", actual_n_seq==30)
supp_data4 %>% write_csv("/Users/noa/Workspace/lasso_positions_sampling_results/supp4.csv")
supp_data4<-  all_msa_running_time  %>% select (dataset_name,actual_n_seq, starting_tree_id,naive_SPR_SPR_ll,naive_SPR_spr_moves,run_time_naive, phase_0_SPR_ll,phase_0_spr_moves,run_time_lasso_phase0,final_phase_spr_moves,final_phase_SPR_ll,run_time_lasso_final_phase, run_time_lasso)
supp_data4
supp_data4 %>% filter (dataset_name=="NagyA1", actual_n_seq==30)
supp_data4 %>% write_csv("/Users/noa/Workspace/lasso_positions_sampling_results/supp4.csv")
supp_data4<-  all_msa_running_time  %>% select (dataset_name,actual_n_seq, starting_tree_id,naive_SPR_SPR_ll,naive_SPR_spr_moves,run_time_naive, phase_0_SPR_ll,phase_0_spr_moves,run_time_lasso_phase0,final_phase_spr_moves,run_time_lasso_final_phase, run_time_lasso) %>% mutate(lasso_total_spr_moves = phase_0_spr_moves+final_phase_spr_moves)
supp_data4
supp_data4 %>% filter (dataset_name=="NagyA1", actual_n_seq==30)
supp_data4 %>% write_csv("/Users/noa/Workspace/lasso_positions_sampling_results/supp4.csv")
supp_data4<-  all_msa_running_time  %>% select (dataset_name,actual_n_seq, starting_tree_id,naive_SPR_SPR_ll,naive_SPR_spr_moves,run_time_naive, phase_0_SPR_ll,phase_0_spr_moves,run_time_lasso_phase0,final_phase_spr_moves,run_time_lasso_final_phase, run_time_lasso) %>% mutate(lasso_total_spr_moves = phase_0_spr_moves+final_phase_spr_moves)
supp_data4
supp_data4 %>% filter (dataset_name=="NagyA1", actual_n_seq==30)
supp_data4 %>% write_csv("/Users/noa/Workspace/lasso_positions_sampling_results/supp4.csv")
supp_data4<-  all_msa_running_time  %>% select (dataset_name,actual_n_seq, starting_tree_id,naive_SPR_SPR_ll,naive_SPR_spr_moves,run_time_naive, phase_0_SPR_ll,phase_0_spr_moves,run_time_lasso_phase0,final_phase_SPR_ll,final_phase_spr_moves, run_time_lasso) %>% mutate(lasso_total_spr_moves = phase_0_spr_moves+final_phase_spr_moves) %>% select (dataset_name,actual_n_seq, starting_tree_id,naive_SPR_SPR_ll,naive_SPR_spr_moves,run_time_naive, phase_0_SPR_ll,phase_0_spr_moves,run_time_lasso_phase0,final_phase_SPR_ll,final_phase_spr_moves, run_time_lasso)
supp_data4
supp_data4 %>% filter (dataset_name=="NagyA1", actual_n_seq==30)
supp_data4 %>% write_csv("/Users/noa/Workspace/lasso_positions_sampling_results/supp4.csv")
supp_data4<-  all_msa_running_time  %>% select (dataset_name,actual_n_seq, starting_tree_id,naive_SPR_SPR_ll,naive_SPR_spr_moves,run_time_naive, phase_0_SPR_ll,phase_0_spr_moves,run_time_lasso_phase0,final_phase_SPR_ll,final_phase_spr_moves, run_time_lasso) %>% mutate(lasso_total_spr_moves = phase_0_spr_moves+final_phase_spr_moves) %>% select (dataset_name,actual_n_seq, starting_tree_id,naive_SPR_SPR_ll,naive_SPR_spr_moves,run_time_naive, phase_0_SPR_ll,phase_0_spr_moves,run_time_lasso_phase0,final_phase_SPR_ll,lasso_total_spr_moves, run_time_lasso)
supp_data4
supp_data4 %>% filter (dataset_name=="NagyA1", actual_n_seq==30)
supp_data4 %>% write_csv("/Users/noa/Workspace/lasso_positions_sampling_results/supp4.csv")
supp_data4<-  all_msa_running_time  %>% select (dataset_name,actual_n_seq, starting_tree_id,naive_SPR_SPR_ll,naive_SPR_spr_moves,run_time_naive, phase_0_SPR_ll,phase_0_spr_moves,run_time_lasso_phase0,final_phase_SPR_ll,final_phase_spr_moves, run_time_lasso, run_time_training) %>% mutate(lasso_total_spr_moves = phase_0_spr_moves+final_phase_spr_move) %>% select (dataset_name,actual_n_seq, starting_tree_id,naive_SPR_SPR_ll,naive_SPR_spr_moves,run_time_naive, phase_0_SPR_ll,phase_0_spr_moves,run_time_lasso_phase0,final_phase_SPR_ll,lasso_total_spr_moves, run_time_lasso,run_time_training)
supp_data4<-  all_msa_running_time  %>% select (dataset_name,actual_n_seq, starting_tree_id,naive_SPR_SPR_ll,naive_SPR_spr_moves,run_time_naive, phase_0_SPR_ll,phase_0_spr_moves,run_time_lasso_phase0,final_phase_SPR_ll,final_phase_spr_moves, run_time_lasso, run_time_training) %>% mutate(lasso_total_spr_moves = phase_0_spr_moves+final_phase_spr_moves) %>% select (dataset_name,actual_n_seq, starting_tree_id,naive_SPR_SPR_ll,naive_SPR_spr_moves,run_time_naive, phase_0_SPR_ll,phase_0_spr_moves,run_time_lasso_phase0,final_phase_SPR_ll,lasso_total_spr_moves, run_time_lasso,run_time_training)
supp_data4
supp_data4 %>% filter (dataset_name=="NagyA1", actual_n_seq==30)
supp_data4 %>% write_csv("/Users/noa/Workspace/lasso_positions_sampling_results/supp4.csv")
((2,521,335.5-2,521,360.5)/2,521,360.5)*100
((2521335.5-2521360.5)/2521360.5)*100
example_msa_data<- new_format_lasso_data %>% filter (dataset_name=="NagyA1", actual_n_seq==30, actual_n_loci == 80000)
example_msa_data_specific_configuration<- example_msa_data %>% filter (actual_sample_pct==0.05, actual_training_size==4000)
example_msa_data_specific_configuration %>% select (alpha, number_loci_chosen, `lasso_test_R^2`, lasso_test_spearmanr )
example_msa_training_ll<- read_csv("/Users/noa/Workspace/lasso_positions_sampling_results/NagyA1_training.csv")
g01<-ggplot(example_msa_test_ll,aes(true_test_ll, predicted_test_ll)) +theme_classic()+
geom_smooth(method='lm')+xlab("True LL")+ylab("Predicted LL ")+geom_point()+ labs(title="")+theme(plot.title = element_text(hjust = 0.5))+ theme(plot.title = element_text(hjust = 0.5))+theme(axis.text=element_text(size=11),
axis.title=element_text(size=11)) #+ ggtitle("Test set predicted log-likelihood vs. true log-likelihood")
g02<-ggplot(example_msa_training_ll,aes(true_training_ll, predicted_training_ll)) +theme_classic()+
geom_smooth(method='lm')+xlab("True LL")+ylab("Predicted LL ")+geom_point()+ labs(title="")+theme(plot.title = element_text(hjust = 0.5))+ theme(plot.title = element_text(hjust = 0.5))+theme(axis.text=element_text(size=11),
axis.title=element_text(size=11)) #+ggtitle("Training set predicted log-likelihood vs. true log-likelihood")
ggarrange(g02, g01, hjust=-1,vjust=1, heights=c(2,2),common.legend=TRUE,
labels = c("A", "B"),
ncol = 1, nrow =2)
r2.taining<- cor.test(example_msa_training_ll$predicted_training_ll,example_msa_training_ll$true_training_ll )
r2.test<- cor.test(example_msa_test_ll$predicted_test_ll,example_msa_test_ll$true_test_ll )
r2.taining
r2.test
r2.taining.spearman<- cor.test(example_msa_training_ll$predicted_training_ll,example_msa_training_ll$true_training_ll, method = "spearman" )
r2.test.spearman<- cor.test(example_msa_test_ll$predicted_test_ll,example_msa_test_ll$true_test_ll, method = "spearman" )
r2.taining.spearman
r2.test.spearman
example_msa_training_ll %>% mutate(error_pct = round(abs((true_training_ll-predicted_training_ll)/true_training_ll)*100,3)) %>% head(5)
example_msa_test_ll %>% mutate(error_pct = round(abs((true_test_ll-predicted_test_ll)/true_test_ll)*100,3)) %>% head(5)
full_r4s<- read_csv("/Users/noa/Workspace/lasso_positions_sampling_results/NagyA1_full_rate4site ")
full_r4s<- read_csv("/Users/noa/Workspace/lasso_positions_sampling_results/NagyA1_full_rate4site ")
full_r4s<- read_csv("/Users/noa/Workspace/lasso_positions_sampling_results/NagyA1_full_rate4site")
lasso_r4s<- read_csv("/Users/noa/Workspace/lasso_positions_sampling_results/NagyA1_lasso_rate4site")
full_r4s<- full_r4s %>% mutate(data = "All MSA positions")
full_r4s
lasso_r4s<- lasso_r4s %>% mutate(data = "Positions chosen by Lasso")
lasso_r4s
all_r4s_data_nagy<-rbind(full_r4s,lasso_r4s) %>% mutate(dataset="ShenA9")
all_r4s_data_nagy
all_r4s_data %>% ggplot(aes(x = Numbers, fill = data)) +
geom_histogram(bins=8,aes(y=..density..),
alpha=0.5,position='identity',binwidth=0.5) + labs(fill = "Positions", x = "Standartaized rates", y= "Density")
#summary(lasso_r4s %>% pull(Numbers))
#ttest<-t.test(lasso_r4s %>% pull(Numbers),full_r4s%>%pull(Numbers))
full_r4s<- read_csv("/Users/noa/Workspace/lasso_positions_sampling_results/ShenA9_full_rate4site")
lasso_r4s<- read_csv("/Users/noa/Workspace/lasso_positions_sampling_results/ShenA9_lasso_rate4site")
full_r4s<- full_r4s %>% mutate(data = "All MSA positions")
full_r4s
lasso_r4s<- lasso_r4s %>% mutate(data = "Positions chosen by Lasso")
lasso_r4s
all_r4s_data_shen<-rbind(full_r4s,lasso_r4s)  %>% mutate(dataset="ShenA9")
all_r4s_data_shen %>% ggplot(aes(x = Numbers, fill = data)) +
geom_histogram(bins=8,aes(y=..density..),
alpha=0.5,position='identity',binwidth=0.5) + labs(fill = "Positions", x = "Standartaized rates", y= "Density")
summary(lasso_r4s %>% pull(Numbers))
ttest<-t.test(lasso_r4s %>% pull(Numbers),full_r4s%>%pull(Numbers))
full_r4s<- read_csv("/Users/noa/Workspace/lasso_positions_sampling_results/YangA8_full_rate4site")
lasso_r4s<- read_csv("/Users/noa/Workspace/lasso_positions_sampling_results/YangA8_lasso_rate4site")
full_r4s<- full_r4s %>% mutate(data = "All MSA positions")
full_r4s
lasso_r4s<- lasso_r4s %>% mutate(data = "Positions chosen by Lasso")
lasso_r4s
all_r4s_data_yang<-rbind(full_r4s,lasso_r4s)  %>% mutate(dataset="YangA8")
all_r4s_data_yang
all_r4s_data %>% ggplot(aes(x = Numbers, fill = data)) +
geom_histogram(bins=8,aes(y=..density..),
alpha=0.5,position='identity',binwidth=0.5) + labs(fill = "Positions", x = "Standartaized rates", y= "Density")
summary(lasso_r4s %>% pull(Numbers))
ttest<-t.test(lasso_r4s %>% pull(Numbers),full_r4s%>%pull(Numbers))
full_r4s<- read_csv("/Users/noa/Workspace/lasso_positions_sampling_results/MisoA2_full_rate4site")
lasso_r4s<- read_csv("/Users/noa/Workspace/lasso_positions_sampling_results/MisoA2_lasso_rate4site")
full_r4s<- full_r4s %>% mutate(data = "All MSA positions")
full_r4s
lasso_r4s<- lasso_r4s %>% mutate(data = "Positions chosen by Lasso")
lasso_r4s
all_r4s_data_miso<-rbind(full_r4s,lasso_r4s) %>% mutate(dataset="MisoA2")
all_r4s_data_miso
all_r4s_data_miso %>% ggplot(aes(x = Numbers, fill = data)) +
geom_histogram(bins=8,aes(y=..density..),
alpha=0.5,position='identity',binwidth=0.5) + labs(fill = "Positions", x = "Standartaized rates", y= "Density")
summary(lasso_r4s %>% pull(Numbers))
ttest<-t.test(lasso_r4s %>% pull(Numbers),full_r4s%>%pull(Numbers))
full_r4s<- read_csv("/Users/noa/Workspace/lasso_positions_sampling_results/StruA5_full_rate4site")
lasso_r4s<- read_csv("/Users/noa/Workspace/lasso_positions_sampling_results/StruA5_lasso_rate4site")
full_r4s<- full_r4s %>% mutate(data = "All MSA positions")
full_r4s
lasso_r4s<- lasso_r4s %>% mutate(data = "Positions chosen by Lasso")
lasso_r4s
all_r4s_data<-rbind(full_r4s,lasso_r4s)  %>% mutate(dataset="StruA5")
all_r4s_data
all_r4s_data %>% ggplot(aes(x = Numbers, fill = data)) +
geom_histogram(bins=8,aes(y=..density..),
alpha=0.5,position='identity',binwidth=0.5) + labs(fill = "Positions", x = "Standartaized rates", y= "Density")
summary(lasso_r4s %>% pull(Numbers))
ttest<-t.test(lasso_r4s %>% pull(Numbers),full_r4s%>%pull(Numbers))
full_r4s<- read_csv("/Users/noa/Workspace/lasso_positions_sampling_results/WickA3_full_rate4site")
lasso_r4s<- read_csv("/Users/noa/Workspace/lasso_positions_sampling_results/WickA3_lasso_rate4site")
full_r4s<- full_r4s %>% mutate(data = "All MSA positions")
full_r4s
lasso_r4s<- lasso_r4s %>% mutate(data = "Positions chosen by Lasso")
lasso_r4s
all_r4s_data<-rbind(full_r4s,lasso_r4s) %>% mutate(dataset = "WickA3")
all_r4s_data
all_r4s_data %>% ggplot(aes(x = Numbers, fill = data)) +
geom_histogram(bins=8,aes(y=..density..),
alpha=0.5,position='identity',binwidth=0.5) + labs(fill = "Positions", x = "Standartaized rates", y= "Density")
summary(lasso_r4s %>% pull(Numbers))
ttest<-t.test(lasso_r4s %>% pull(Numbers),full_r4s%>%pull(Numbers))
new_format_lasso_data  %>%  mutate (unexplained_var = 1-`lasso_test_R^2`) %>%
filter (actual_n_loci==80000, dataset_name %in% c("MisoA2","NagyA1","ShenA9")) %>%
ggplot(aes(x=actual_sample_pct,y=unexplained_var, group = interaction(actual_training_size,dataset_name), color = as.factor(actual_training_size)))+ geom_line() + geom_point(size=1.5) + scale_x_continuous(labels = scales::percent,breaks = c(0.01,0.025,0.05,0.1)) +labs(color="Training size" ,x="Sample percentage",y="Unexplained variance on test set (%)") + theme_classic()+facet_grid(cols = vars(dataset_name), rows=  vars(actual_n_seq)) + theme(axis.text.x = element_text(angle = 60, vjust = 0.9, hjust=1))
new_format_lasso_data  %>%  mutate (unexplained_var = 1-`lasso_test_R^2`) %>%
filter (actual_n_loci==80000, dataset_name %in% c("YangA8","StruA5","WickA3")) %>%
ggplot(aes(x=actual_sample_pct,y=unexplained_var, group = interaction(actual_training_size,dataset_name), color = as.factor(actual_training_size)))+ geom_line() + geom_point(size=1.5) + scale_x_continuous(labels = scales::percent,breaks = c(0.01,0.025,0.05,0.1)) +labs(color="Training size" ,x="Sample percentage",y="Unexplained variance on test set (%)") + theme_classic()+facet_grid(cols = vars(dataset_name), rows=  vars(actual_n_seq)) + theme(axis.text.x = element_text(angle = 60, vjust = 0.9, hjust=1))
new_format_lasso_data  %>%  mutate (unexplained_var = 1-`lasso_test_R^2`) %>%
filter (actual_n_loci==40000, dataset_name %in% c("MisoA2","NagyA1","ShenA9")) %>%
ggplot(aes(x=actual_sample_pct,y=unexplained_var, group = interaction(actual_training_size,dataset_name), color = as.factor(actual_training_size)))+ geom_line() + geom_point(size=1.5) + scale_x_continuous(labels = scales::percent,breaks = c(0.01,0.025,0.05,0.1)) +labs(color="Training size" ,x="Sample percentage",y="Unexplained variance on test set (%)") + theme_classic()+facet_grid(cols = vars(dataset_name), rows=  vars(actual_n_seq)) + theme(axis.text.x = element_text(angle = 60, vjust = 0.9, hjust=1))
new_format_lasso_data  %>%  mutate (unexplained_var = 1-`lasso_test_R^2`) %>%
filter (actual_n_loci==40000, dataset_name %in% c("YangA8","StruA5","WickA3")) %>%
ggplot(aes(x=actual_sample_pct,y=unexplained_var, group = interaction(actual_training_size,dataset_name), color = as.factor(actual_training_size)))+ geom_line() + geom_point(size=1.5) + scale_x_continuous(labels = scales::percent,breaks = c(0.01,0.025,0.05,0.1)) +labs(color="Training size" ,x="Sample percentage",y="Unexplained variance on test set (%)") + theme_classic()+facet_grid(cols = vars(dataset_name), rows=  vars(actual_n_seq)) + theme(axis.text.x = element_text(angle = 60, vjust = 0.9, hjust=1))
new_format_lasso_data  %>%  mutate (unexplained_var = 1-`lasso_test_R^2`) %>%
filter (actual_n_loci==20000, dataset_name %in% c("MisoA2","NagyA1","ShenA9")) %>%
ggplot(aes(x=actual_sample_pct,y=unexplained_var, group = interaction(actual_training_size,dataset_name), color = as.factor(actual_training_size)))+ geom_line() + geom_point(size=1.5) + scale_x_continuous(labels = scales::percent,breaks = c(0.01,0.025,0.05,0.1)) +labs(color="Training size" ,x="Sample percentage",y="Unexplained variance on test set (%)") + theme_classic()+facet_grid(cols = vars(dataset_name), rows=  vars(actual_n_seq)) + theme(axis.text.x = element_text(angle = 60, vjust = 0.9, hjust=1))
new_format_lasso_data  %>%  mutate (unexplained_var = 1-`lasso_test_R^2`) %>%
filter (actual_n_loci==20000, dataset_name %in% c("YangA8","StruA5","WickA3")) %>%
ggplot(aes(x=actual_sample_pct,y=unexplained_var, group = interaction(actual_training_size,dataset_name), color = as.factor(actual_training_size)))+ geom_line() + geom_point(size=1.5) + scale_x_continuous(labels = scales::percent,breaks = c(0.01,0.025,0.05,0.1)) +labs(color="Training size" ,x="Sample percentage",y="Unexplained variance on test set (%)") + theme_classic()+facet_grid(cols = vars(dataset_name), rows=  vars(actual_n_seq)) + theme(axis.text.x = element_text(angle = 60, vjust = 0.9, hjust=1))
full_r4s<- read_csv("/Users/noa/Workspace/lasso_positions_sampling_results/NagyA1_full_rate4site")
lasso_r4s<- read_csv("/Users/noa/Workspace/lasso_positions_sampling_results/NagyA1_lasso_rate4site")
full_r4s<- full_r4s %>% mutate(data = "All MSA positions")
full_r4s
lasso_r4s<- lasso_r4s %>% mutate(data = "Positions chosen by Lasso")
lasso_r4s
all_r4s_data_nagy<-rbind(full_r4s,lasso_r4s) %>% mutate(dataset="ShenA9")
all_r4s_data_nagy
all_r4s_data %>% ggplot(aes(x = Numbers, fill = data)) +
geom_histogram(bins=8,aes(y=..density..),
alpha=0.5,position='identity',binwidth=0.5) + labs(fill = "", x = "Standartaized rates", y= "Density")
#summary(lasso_r4s %>% pull(Numbers))
#ttest<-t.test(lasso_r4s %>% pull(Numbers),full_r4s%>%pull(Numbers))
full_r4s<- read_csv("/Users/noa/Workspace/lasso_positions_sampling_results/NagyA1_full_rate4site")
lasso_r4s<- read_csv("/Users/noa/Workspace/lasso_positions_sampling_results/NagyA1_lasso_rate4site")
full_r4s<- full_r4s %>% mutate(data = "All MSA positions")
full_r4s
lasso_r4s<- lasso_r4s %>% mutate(data = "Positions chosen by Lasso")
lasso_r4s
all_r4s_data_nagy<-rbind(full_r4s,lasso_r4s) %>% mutate(dataset="ShenA9")
all_r4s_data_nagy
all_r4s_data %>% ggplot(aes(x = Numbers, fill = data)) +
geom_histogram(bins=8,aes(y=..density..),
alpha=0.5,position='identity',binwidth=0.5) + labs(fill = "", x = "Standartaized rates", y= "Density")
#summary(lasso_r4s %>% pull(Numbers))
#ttest<-t.test(lasso_r4s %>% pull(Numbers),full_r4s%>%pull(Numbers))
full_r4s<- read_csv("/Users/noa/Workspace/lasso_positions_sampling_results/ShenA9_full_rate4site")
lasso_r4s<- read_csv("/Users/noa/Workspace/lasso_positions_sampling_results/ShenA9_lasso_rate4site")
full_r4s<- full_r4s %>% mutate(data = "All MSA positions")
full_r4s
lasso_r4s<- lasso_r4s %>% mutate(data = "Positions chosen by Lasso")
lasso_r4s
all_r4s_data_shen<-rbind(full_r4s,lasso_r4s)  %>% mutate(dataset="ShenA9")
all_r4s_data_shen %>% ggplot(aes(x = Numbers, fill = data)) +
geom_histogram(bins=8,aes(y=..density..),
alpha=0.5,position='identity',binwidth=0.5) + labs(fill = "", x = "Standartaized rates", y= "Density")
summary(lasso_r4s %>% pull(Numbers))
ttest<-t.test(lasso_r4s %>% pull(Numbers),full_r4s%>%pull(Numbers))
full_r4s<- read_csv("/Users/noa/Workspace/lasso_positions_sampling_results/YangA8_full_rate4site")
lasso_r4s<- read_csv("/Users/noa/Workspace/lasso_positions_sampling_results/YangA8_lasso_rate4site")
full_r4s<- full_r4s %>% mutate(data = "All MSA positions")
full_r4s
lasso_r4s<- lasso_r4s %>% mutate(data = "Positions chosen by Lasso")
lasso_r4s
all_r4s_data_yang<-rbind(full_r4s,lasso_r4s)  %>% mutate(dataset="YangA8")
all_r4s_data_yang
all_r4s_data %>% ggplot(aes(x = Numbers, fill = data)) +
geom_histogram(bins=8,aes(y=..density..),
alpha=0.5,position='identity',binwidth=0.5) + labs(fill = "", x = "Standartaized rates", y= "Density")
summary(lasso_r4s %>% pull(Numbers))
ttest<-t.test(lasso_r4s %>% pull(Numbers),full_r4s%>%pull(Numbers))
full_r4s<- read_csv("/Users/noa/Workspace/lasso_positions_sampling_results/MisoA2_full_rate4site")
lasso_r4s<- read_csv("/Users/noa/Workspace/lasso_positions_sampling_results/MisoA2_lasso_rate4site")
full_r4s<- full_r4s %>% mutate(data = "All MSA positions")
full_r4s
lasso_r4s<- lasso_r4s %>% mutate(data = "Positions chosen by Lasso")
lasso_r4s
all_r4s_data_miso<-rbind(full_r4s,lasso_r4s) %>% mutate(dataset="MisoA2")
all_r4s_data_miso
all_r4s_data_miso %>% ggplot(aes(x = Numbers, fill = data)) +
geom_histogram(bins=8,aes(y=..density..),
alpha=0.5,position='identity',binwidth=0.5) + labs(fill = "", x = "Standartaized rates", y= "Density")
summary(lasso_r4s %>% pull(Numbers))
ttest<-t.test(lasso_r4s %>% pull(Numbers),full_r4s%>%pull(Numbers))
full_r4s<- read_csv("/Users/noa/Workspace/lasso_positions_sampling_results/StruA5_full_rate4site")
lasso_r4s<- read_csv("/Users/noa/Workspace/lasso_positions_sampling_results/StruA5_lasso_rate4site")
full_r4s<- full_r4s %>% mutate(data = "All MSA positions")
full_r4s
lasso_r4s<- lasso_r4s %>% mutate(data = "Positions chosen by Lasso")
lasso_r4s
all_r4s_data<-rbind(full_r4s,lasso_r4s)  %>% mutate(dataset="StruA5")
all_r4s_data
all_r4s_data %>% ggplot(aes(x = Numbers, fill = data)) +
geom_histogram(bins=8,aes(y=..density..),
alpha=0.5,position='identity',binwidth=0.5) + labs(fill = "", x = "Standartaized rates", y= "Density")
summary(lasso_r4s %>% pull(Numbers))
ttest<-t.test(lasso_r4s %>% pull(Numbers),full_r4s%>%pull(Numbers))
full_r4s<- read_csv("/Users/noa/Workspace/lasso_positions_sampling_results/WickA3_full_rate4site")
lasso_r4s<- read_csv("/Users/noa/Workspace/lasso_positions_sampling_results/WickA3_lasso_rate4site")
full_r4s<- full_r4s %>% mutate(data = "All MSA positions")
full_r4s
lasso_r4s<- lasso_r4s %>% mutate(data = "Positions chosen by Lasso")
lasso_r4s
all_r4s_data<-rbind(full_r4s,lasso_r4s) %>% mutate(dataset = "WickA3")
all_r4s_data
all_r4s_data %>% ggplot(aes(x = Numbers, fill = data)) +
geom_histogram(bins=8,aes(y=..density..),
alpha=0.5,position='identity',binwidth=0.5) + labs(fill = "", x = "Standartaized rates", y= "Density")
summary(lasso_r4s %>% pull(Numbers))
ttest<-t.test(lasso_r4s %>% pull(Numbers),full_r4s%>%pull(Numbers))
new_format_lasso_data  %>%  mutate (unexplained_var = 1-`lasso_test_R^2`) %>%
filter (actual_n_loci==80000, dataset_name %in% c("MisoA2","NagyA1","ShenA9")) %>%
ggplot(aes(x=actual_sample_pct,y=unexplained_var, group = interaction(actual_training_size,dataset_name), color = as.factor(actual_training_size)))+ geom_line() + geom_point(size=1.5) + scale_x_continuous(labels = scales::percent,breaks = c(0.01,0.025,0.05,0.1)) +labs(color="Training size" ,x="Sample percentage",y="Unexplained variance on test set (%)") + theme_classic()+facet_grid(cols = vars(dataset_name), rows=  vars(actual_n_seq)) + theme(axis.text.x = element_text(angle = 60, vjust = 0.9, hjust=1))
new_format_lasso_data  %>%  mutate (unexplained_var = 1-`lasso_test_R^2`) %>%
filter (actual_n_loci==80000, dataset_name %in% c("YangA8","StruA5","WickA3")) %>%
ggplot(aes(x=actual_sample_pct,y=unexplained_var, group = interaction(actual_training_size,dataset_name), color = as.factor(actual_training_size)))+ geom_line() + geom_point(size=1.5) + scale_x_continuous(labels = scales::percent,breaks = c(0.01,0.025,0.05,0.1)) +labs(color="Training size" ,x="Sample percentage",y="Unexplained variance on test set (%)") + theme_classic()+facet_grid(cols = vars(dataset_name), rows=  vars(actual_n_seq)) + theme(axis.text.x = element_text(angle = 60, vjust = 0.9, hjust=1))
new_format_lasso_data  %>%  mutate (unexplained_var = 1-`lasso_test_R^2`) %>%
filter (actual_n_loci==40000, dataset_name %in% c("MisoA2","NagyA1","ShenA9")) %>%
ggplot(aes(x=actual_sample_pct,y=unexplained_var, group = interaction(actual_training_size,dataset_name), color = as.factor(actual_training_size)))+ geom_line() + geom_point(size=1.5) + scale_x_continuous(labels = scales::percent,breaks = c(0.01,0.025,0.05,0.1)) +labs(color="Training size" ,x="Sample percentage",y="Unexplained variance on test set (%)") + theme_classic()+facet_grid(cols = vars(dataset_name), rows=  vars(actual_n_seq)) + theme(axis.text.x = element_text(angle = 60, vjust = 0.9, hjust=1))
new_format_lasso_data  %>%  mutate (unexplained_var = 1-`lasso_test_R^2`) %>%
filter (actual_n_loci==40000, dataset_name %in% c("YangA8","StruA5","WickA3")) %>%
ggplot(aes(x=actual_sample_pct,y=unexplained_var, group = interaction(actual_training_size,dataset_name), color = as.factor(actual_training_size)))+ geom_line() + geom_point(size=1.5) + scale_x_continuous(labels = scales::percent,breaks = c(0.01,0.025,0.05,0.1)) +labs(color="Training size" ,x="Sample percentage",y="Unexplained variance on test set (%)") + theme_classic()+facet_grid(cols = vars(dataset_name), rows=  vars(actual_n_seq)) + theme(axis.text.x = element_text(angle = 60, vjust = 0.9, hjust=1))
new_format_lasso_data  %>%  mutate (unexplained_var = 1-`lasso_test_R^2`) %>%
filter (actual_n_loci==20000, dataset_name %in% c("MisoA2","NagyA1","ShenA9")) %>%
ggplot(aes(x=actual_sample_pct,y=unexplained_var, group = interaction(actual_training_size,dataset_name), color = as.factor(actual_training_size)))+ geom_line() + geom_point(size=1.5) + scale_x_continuous(labels = scales::percent,breaks = c(0.01,0.025,0.05,0.1)) +labs(color="Training size" ,x="Sample percentage",y="Unexplained variance on test set (%)") + theme_classic()+facet_grid(cols = vars(dataset_name), rows=  vars(actual_n_seq)) + theme(axis.text.x = element_text(angle = 60, vjust = 0.9, hjust=1))
new_format_lasso_data  %>%  mutate (unexplained_var = 1-`lasso_test_R^2`) %>%
filter (actual_n_loci==20000, dataset_name %in% c("YangA8","StruA5","WickA3")) %>%
ggplot(aes(x=actual_sample_pct,y=unexplained_var, group = interaction(actual_training_size,dataset_name), color = as.factor(actual_training_size)))+ geom_line() + geom_point(size=1.5) + scale_x_continuous(labels = scales::percent,breaks = c(0.01,0.025,0.05,0.1)) +labs(color="Training size" ,x="Sample percentage",y="Unexplained variance on test set (%)") + theme_classic()+facet_grid(cols = vars(dataset_name), rows=  vars(actual_n_seq)) + theme(axis.text.x = element_text(angle = 60, vjust = 0.9, hjust=1))
example_msa_iterations<-example_msa_iterations %>% mutate(phase_name=factor(phase_name, levels = c("Standard search","Lasso-only search","Second phase of Two-phase search")))
example_msa_iterations %>% arrange(desc(phase_name)) %>% ggplot(aes(x= iter-1,y= true_ll,colour = phase_name)) + geom_point(size=0.5)+ geom_line(size=1.2)+labs(x="Iteration number" ,y = "Log-likelihood")+theme_classic()+guides(col=guide_legend(""))+theme(strip.text.y = element_text(angle = 0))
options(digits=10)
n_cores_full =15
n_cores_lasso = 1
example_msa_data<-spr_data_edited %>% filter (dataset_name=="NagyA1",actual_n_seq==30)
example_msa_data %>% select (delta_ll_final,delta_ll_phase_0,naive_SPR_running_time, phase_0_running_time, final_phase_running_time, naive_SPR_spr_moves,phase_0_spr_moves,final_phase_spr_moves,final_phase_SPR_ll,phase_0_SPR_ll, naive_SPR_starting_tree_SPR_ll, naive_SPR_SPR_ll )
example_msa_naive_iterations<- read_tsv("/Users/noa/Workspace/lasso_positions_sampling_results/nagy_full_iterations2.tsv") %>% mutate (iter = row_number(),phase_name = "Standard search", search_type = "Search on full MSA", cpu_time_per_iter = total_times*n_cores_full, overall_time = cumsum(cpu_time_per_iter))
example_msa_lasso_iterations<- read_tsv("/Users/noa/Workspace/lasso_positions_sampling_results/nagy_lasso_iterations2.tsv") %>% mutate( iter= row_number(), phase_name = ifelse(phase_name=="0_phase","Lasso-only search","Second phase of Two-phase search"), search_type = "Search using 5% of MSA sites" ) %>% mutate(cpu_time_per_iter= ifelse(phase_name=="0_phase",brlen_times+no_brlen_times, brlen_times*n_cpus_full+no_brlen_times)) %>% mutate (overall_time = cumsum(cpu_time_per_iter))
example_msa_lasso_iterations %>% select (phase_name, ll, true_ll)
best_ll = max(c(example_msa_naive_iterations %>% pull (true_ll),example_msa_lasso_iterations %>% pull (true_ll)))
start_ll = example_msa_naive_iterations %>% pull(true_ll)
example_msa_iterations<-rbind(example_msa_naive_iterations,example_msa_lasso_iterations)
# local_ll
example_msa_iterations %>% ggplot(aes(x= iter-1,y= ll,colour = phase_name)) + geom_point(size=0.5)+ geom_line()+labs(x="Iteration number" ,y = "local log-likelihood")+theme_classic()+guides(col=guide_legend("Search type"))+theme(strip.text.y = element_text(angle = 0))
# Delta_ll
example_msa_iterations %>% ggplot(aes(x= iter-1,y= best_ll-true_ll,colour = phase_name)) + geom_point(size=0.5)+ geom_line()+labs(x="Iteration number" ,y = "Delta log-likelihood")+theme_classic()+guides(col=guide_legend("Search type"))+theme(strip.text.y = element_text(angle = 0))
# best_ll
example_msa_iterations %>% ggplot(aes(x= iter-1,y= true_ll,colour = phase_name)) + geom_point(size=0.5)+ geom_line(size = 1)+labs(x="Iteration number" ,y = "Log-likelihood")+theme_classic()+guides(col=guide_legend("Search type"))+theme(strip.text.y = element_text(angle = 0))
# running_times_no_brlen
example_msa_iterations %>% ggplot(aes(x= iter-1,y= no_brlen_times,colour = phase_name)) + geom_point(size=0.5)+ geom_line()+labs(x="Iteration number" ,y = "No-brlen running times")+theme_classic()+guides(col=guide_legend("Search type"))+theme(strip.text.y = element_text(angle = 0))
# running_times_=brlen
example_msa_iterations %>% ggplot(aes(x= iter-1,y= brlen_times,colour = phase_name)) + geom_point(size=0.5)+ geom_line()+labs(x="Iteration number" ,y = "brlen running times")+theme_classic()+guides(col=guide_legend("Search type"))+theme(strip.text.y = element_text(angle = 0))
example_msa_iterations %>% ggplot(aes(x= iter-1,y= n_spr_eval,colour = phase_name)) + geom_point(size=0.5)+ geom_line()+labs(x="Iteration number" ,y = "N SPR eval")+theme_classic()+guides(col=guide_legend("Search type"))+theme(strip.text.y = element_text(angle = 0))
# running_time_analysis
example_msa_data %>% select (naive_SPR_no_brlen_running_time,naive_SPR_brlen_running_time, phase_0_no_brlen_running_time, phase_0_brlen_running_time,final_phase_no_brlen_running_time, final_phase_brlen_running_time, full_size_training_evaluation_time_phase_0, lasso_running_time_phase_0) %>% mutate (run_time_naive = n_cores_full*(naive_SPR_no_brlen_running_time+naive_SPR_brlen_running_time), run_time_lasso = n_cores_lasso*(phase_0_no_brlen_running_time+phase_0_brlen_running_time) + n_cores_lasso*final_phase_no_brlen_running_time+n_cores_full*final_phase_brlen_running_time, run_time_training = full_size_training_evaluation_time_phase_0* n_cores_full, run_time_lasso_algorithm =lasso_running_time_phase_0  ) %>% mutate(ratio_including_training =run_time_naive/(run_time_lasso+run_time_training+run_time_lasso_algorithm
) , ratio_without_training =run_time_naive/run_time_lasso)
# Operations and SPR moves analysis
example_msa_data %>% select (phase_0_spr_moves,naive_SPR_spr_moves,final_phase_spr_moves,naive_SPR_total_spr_neighbours_evaluated,naive_SPR_total_spr_neighbours_optimized, phase_0_total_spr_neighbours_evaluated, phase_0_total_spr_neighbours_optimized,final_phase_total_spr_neighbours_evaluated, final_phase_total_spr_neighbours_optimized, full_size_training_evaluation_time_phase_0) %>% mutate (naive_full_brlen_opt = naive_SPR_total_spr_neighbours_optimized,naive_full_eval =naive_SPR_total_spr_neighbours_evaluated, lasso_sampled_eval =phase_0_total_spr_neighbours_evaluated+final_phase_total_spr_neighbours_evaluated, lasso_sampled_optimized = phase_0_total_spr_neighbours_optimized, lasso_full_optimized = final_phase_total_spr_neighbours_optimized )
options(digits=10)
n_cores_full =15
n_cores_lasso = 1
example_msa_data<-spr_data_edited %>% filter (dataset_name=="NagyA1",actual_n_seq==30)
example_msa_data %>% select (delta_ll_final,delta_ll_phase_0,naive_SPR_running_time, phase_0_running_time, final_phase_running_time, naive_SPR_spr_moves,phase_0_spr_moves,final_phase_spr_moves,final_phase_SPR_ll,phase_0_SPR_ll, naive_SPR_starting_tree_SPR_ll, naive_SPR_SPR_ll )
example_msa_naive_iterations<- read_tsv("/Users/noa/Workspace/lasso_positions_sampling_results/nagy_full_iterations2.tsv") %>% mutate (iter = row_number(),phase_name = "Standard search", search_type = "Search on full MSA", cpu_time_per_iter = total_times*n_cores_full, overall_time = cumsum(cpu_time_per_iter))
example_msa_lasso_iterations<- read_tsv("/Users/noa/Workspace/lasso_positions_sampling_results/nagy_lasso_iterations2.tsv") %>% mutate( iter= row_number(), phase_name = ifelse(phase_name=="0_phase","Lasso-only search","Second phase of Two-phase search"), search_type = "Search using 5% of MSA sites" ) %>% mutate(cpu_time_per_iter= ifelse(phase_name=="0_phase",brlen_times+no_brlen_times, brlen_times*n_cpus_full+no_brlen_times)) %>% mutate (overall_time = cumsum(cpu_time_per_iter))
example_msa_lasso_iterations %>% select (phase_name, ll, true_ll)
best_ll = max(c(example_msa_naive_iterations %>% pull (true_ll),example_msa_lasso_iterations %>% pull (true_ll)))
start_ll = example_msa_naive_iterations %>% pull(true_ll)
example_msa_iterations<-rbind(example_msa_naive_iterations,example_msa_lasso_iterations)
# local_ll
example_msa_iterations %>% ggplot(aes(x= iter-1,y= ll,colour = phase_name)) + geom_point(size=0.5)+ geom_line()+labs(x="Iteration number" ,y = "local log-likelihood")+theme_classic()+guides(col=guide_legend("Search type"))+theme(strip.text.y = element_text(angle = 0))
# Delta_ll
example_msa_iterations %>% ggplot(aes(x= iter-1,y= best_ll-true_ll,colour = phase_name)) + geom_point(size=0.5)+ geom_line()+labs(x="Iteration number" ,y = "Delta log-likelihood")+theme_classic()+guides(col=guide_legend("Search type"))+theme(strip.text.y = element_text(angle = 0))
# best_ll
example_msa_iterations %>% ggplot(aes(x= iter-1,y= true_ll,colour = phase_name)) + geom_point(size=0.5)+ geom_line(size = 1)+labs(x="Iteration number" ,y = "Log-likelihood")+theme_classic()+guides(col=guide_legend("Search type"))+theme(strip.text.y = element_text(angle = 0))
# running_times_no_brlen
example_msa_iterations %>% ggplot(aes(x= iter-1,y= no_brlen_times,colour = phase_name)) + geom_point(size=0.5)+ geom_line()+labs(x="Iteration number" ,y = "No-brlen running times")+theme_classic()+guides(col=guide_legend("Search type"))+theme(strip.text.y = element_text(angle = 0))
# running_times_=brlen
example_msa_iterations %>% ggplot(aes(x= iter-1,y= brlen_times,colour = phase_name)) + geom_point(size=0.5)+ geom_line()+labs(x="Iteration number" ,y = "brlen running times")+theme_classic()+guides(col=guide_legend("Search type"))+theme(strip.text.y = element_text(angle = 0))
example_msa_iterations %>% ggplot(aes(x= iter-1,y= n_spr_eval,colour = phase_name)) + geom_point(size=0.5)+ geom_line()+labs(x="Iteration number" ,y = "N SPR eval")+theme_classic()+guides(col=guide_legend("Search type"))+theme(strip.text.y = element_text(angle = 0))
# running_time_analysis
example_msa_data %>% select (naive_SPR_no_brlen_running_time,naive_SPR_brlen_running_time, phase_0_no_brlen_running_time, phase_0_brlen_running_time,final_phase_no_brlen_running_time, final_phase_brlen_running_time, full_size_training_evaluation_time_phase_0, lasso_running_time_phase_0) %>% mutate (run_time_naive = n_cores_full*(naive_SPR_no_brlen_running_time+naive_SPR_brlen_running_time), run_time_lasso = n_cores_lasso*(phase_0_no_brlen_running_time+phase_0_brlen_running_time) + n_cores_lasso*final_phase_no_brlen_running_time+n_cores_full*final_phase_brlen_running_time, run_time_training = full_size_training_evaluation_time_phase_0* n_cores_full, run_time_lasso_algorithm =lasso_running_time_phase_0  ) %>% mutate(ratio_including_training =run_time_naive/(run_time_lasso+run_time_training+run_time_lasso_algorithm
) , ratio_without_training =run_time_naive/run_time_lasso)
# Operations and SPR moves analysis
example_msa_data %>% select (phase_0_spr_moves,naive_SPR_spr_moves,final_phase_spr_moves,naive_SPR_total_spr_neighbours_evaluated,naive_SPR_total_spr_neighbours_optimized, phase_0_total_spr_neighbours_evaluated, phase_0_total_spr_neighbours_optimized,final_phase_total_spr_neighbours_evaluated, final_phase_total_spr_neighbours_optimized, full_size_training_evaluation_time_phase_0) %>% mutate (naive_full_brlen_opt = naive_SPR_total_spr_neighbours_optimized,naive_full_eval =naive_SPR_total_spr_neighbours_evaluated, lasso_sampled_eval =phase_0_total_spr_neighbours_evaluated+final_phase_total_spr_neighbours_evaluated, lasso_sampled_optimized = phase_0_total_spr_neighbours_optimized, lasso_full_optimized = final_phase_total_spr_neighbours_optimized )
example_msa_iterations<-example_msa_iterations %>% mutate(phase_name=factor(phase_name, levels = c("Standard search","Lasso-only search","Second phase of Two-phase search")))
example_msa_iterations %>% arrange(desc(phase_name)) %>% ggplot(aes(x= iter-1,y= true_ll,colour = phase_name)) + geom_point(size=0.5)+ geom_line(size=1.2)+labs(x="Iteration number" ,y = "Log-likelihood")+theme_classic()+guides(col=guide_legend(""))+theme(strip.text.y = element_text(angle = 0))
options(digits=10)
n_cores_full =15
n_cores_lasso = 1
example_msa_data<-spr_data_edited %>% filter (dataset_name=="NagyA1",actual_n_seq==30)
example_msa_data %>% select (delta_ll_final,delta_ll_phase_0,naive_SPR_running_time, phase_0_running_time, final_phase_running_time, naive_SPR_spr_moves,phase_0_spr_moves,final_phase_spr_moves,final_phase_SPR_ll,phase_0_SPR_ll, naive_SPR_starting_tree_SPR_ll, naive_SPR_SPR_ll )
example_msa_naive_iterations<- read_tsv("/Users/noa/Workspace/lasso_positions_sampling_results/nagy_full_iterations2.tsv") %>% mutate (iter = row_number(),phase_name = "Standard search", search_type = "Search on full MSA", cpu_time_per_iter = total_times*n_cores_full, overall_time = cumsum(cpu_time_per_iter))
example_msa_lasso_iterations<- read_tsv("/Users/noa/Workspace/lasso_positions_sampling_results/nagy_lasso_iterations2.tsv") %>% mutate( iter= row_number(), phase_name = ifelse(phase_name=="0_phase","Lasso-only search","Second phase of the Two-phase search"), search_type = "Search using 5% of MSA sites" ) %>% mutate(cpu_time_per_iter= ifelse(phase_name=="0_phase",brlen_times+no_brlen_times, brlen_times*n_cpus_full+no_brlen_times)) %>% mutate (overall_time = cumsum(cpu_time_per_iter))
example_msa_lasso_iterations %>% select (phase_name, ll, true_ll)
best_ll = max(c(example_msa_naive_iterations %>% pull (true_ll),example_msa_lasso_iterations %>% pull (true_ll)))
start_ll = example_msa_naive_iterations %>% pull(true_ll)
example_msa_iterations<-rbind(example_msa_naive_iterations,example_msa_lasso_iterations)
# local_ll
example_msa_iterations %>% ggplot(aes(x= iter-1,y= ll,colour = phase_name)) + geom_point(size=0.5)+ geom_line()+labs(x="Iteration number" ,y = "local log-likelihood")+theme_classic()+guides(col=guide_legend("Search type"))+theme(strip.text.y = element_text(angle = 0))
# Delta_ll
example_msa_iterations %>% ggplot(aes(x= iter-1,y= best_ll-true_ll,colour = phase_name)) + geom_point(size=0.5)+ geom_line()+labs(x="Iteration number" ,y = "Delta log-likelihood")+theme_classic()+guides(col=guide_legend("Search type"))+theme(strip.text.y = element_text(angle = 0))
# best_ll
example_msa_iterations %>% ggplot(aes(x= iter-1,y= true_ll,colour = phase_name)) + geom_point(size=0.5)+ geom_line(size = 1)+labs(x="Iteration number" ,y = "Log-likelihood")+theme_classic()+guides(col=guide_legend("Search type"))+theme(strip.text.y = element_text(angle = 0))
# running_times_no_brlen
example_msa_iterations %>% ggplot(aes(x= iter-1,y= no_brlen_times,colour = phase_name)) + geom_point(size=0.5)+ geom_line()+labs(x="Iteration number" ,y = "No-brlen running times")+theme_classic()+guides(col=guide_legend("Search type"))+theme(strip.text.y = element_text(angle = 0))
# running_times_=brlen
example_msa_iterations %>% ggplot(aes(x= iter-1,y= brlen_times,colour = phase_name)) + geom_point(size=0.5)+ geom_line()+labs(x="Iteration number" ,y = "brlen running times")+theme_classic()+guides(col=guide_legend("Search type"))+theme(strip.text.y = element_text(angle = 0))
example_msa_iterations %>% ggplot(aes(x= iter-1,y= n_spr_eval,colour = phase_name)) + geom_point(size=0.5)+ geom_line()+labs(x="Iteration number" ,y = "N SPR eval")+theme_classic()+guides(col=guide_legend("Search type"))+theme(strip.text.y = element_text(angle = 0))
# running_time_analysis
example_msa_data %>% select (naive_SPR_no_brlen_running_time,naive_SPR_brlen_running_time, phase_0_no_brlen_running_time, phase_0_brlen_running_time,final_phase_no_brlen_running_time, final_phase_brlen_running_time, full_size_training_evaluation_time_phase_0, lasso_running_time_phase_0) %>% mutate (run_time_naive = n_cores_full*(naive_SPR_no_brlen_running_time+naive_SPR_brlen_running_time), run_time_lasso = n_cores_lasso*(phase_0_no_brlen_running_time+phase_0_brlen_running_time) + n_cores_lasso*final_phase_no_brlen_running_time+n_cores_full*final_phase_brlen_running_time, run_time_training = full_size_training_evaluation_time_phase_0* n_cores_full, run_time_lasso_algorithm =lasso_running_time_phase_0  ) %>% mutate(ratio_including_training =run_time_naive/(run_time_lasso+run_time_training+run_time_lasso_algorithm
) , ratio_without_training =run_time_naive/run_time_lasso)
# Operations and SPR moves analysis
example_msa_data %>% select (phase_0_spr_moves,naive_SPR_spr_moves,final_phase_spr_moves,naive_SPR_total_spr_neighbours_evaluated,naive_SPR_total_spr_neighbours_optimized, phase_0_total_spr_neighbours_evaluated, phase_0_total_spr_neighbours_optimized,final_phase_total_spr_neighbours_evaluated, final_phase_total_spr_neighbours_optimized, full_size_training_evaluation_time_phase_0) %>% mutate (naive_full_brlen_opt = naive_SPR_total_spr_neighbours_optimized,naive_full_eval =naive_SPR_total_spr_neighbours_evaluated, lasso_sampled_eval =phase_0_total_spr_neighbours_evaluated+final_phase_total_spr_neighbours_evaluated, lasso_sampled_optimized = phase_0_total_spr_neighbours_optimized, lasso_full_optimized = final_phase_total_spr_neighbours_optimized )
example_msa_iterations<-example_msa_iterations %>% mutate(phase_name=factor(phase_name, levels = c("Standard search","Lasso-only search","Second phase of the Two-phase search")))
example_msa_iterations %>% arrange(desc(phase_name)) %>% ggplot(aes(x= iter-1,y= true_ll,colour = phase_name)) + geom_point(size=0.5)+ geom_line(size=1.2)+labs(x="Iteration number" ,y = "Log-likelihood")+theme_classic()+guides(col=guide_legend(""))+theme(strip.text.y = element_text(angle = 0))
