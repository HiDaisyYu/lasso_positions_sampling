---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}
library(lme4)
library(ggplot2)
library(plotrix)
library(visreg)
library(stringr)
library(tidyverse)
library(ggpubr)
library(gridExtra)
library(tidyverse)
library(tidymodels)
library(vip) 
library(plm)
```


```{r}
compare_to_naive_data<-read_tsv("/Users/noa/Workspace/lasso_positions_sampling_results/revision_files/comp_naive.tsv") %>% separate(dataset_id, "_supermatrices_",
                into = c("prefix", "last_value"), 
                remove = FALSE) %>% separate(last_value,"_",into = c("dataset_name", "suffix")) #%>% select(-c("prefix","suffix"))


jtt_data<-read_tsv("/Users/noa/Workspace/lasso_positions_sampling_results/revision_files/jtt.tsv") %>% separate(dataset_id, "_supermatrices_",
                into = c("prefix", "last_value"), 
                remove = FALSE) %>% separate(last_value,"_",into = c("dataset_name", "suffix"))# %>% select(-c("prefix","suffix"))
lg_data<-read_tsv("/Users/noa/Workspace/lasso_positions_sampling_results/revision_files/lg.tsv") %>% separate(dataset_id, "_supermatrices_",
                into = c("prefix", "last_value"), 
                remove = FALSE) %>% separate(last_value,"_",into = c("dataset_name", "suffix")) 
#%>%  select(-c("prefix","suffix"))
gtr_data<-read_tsv("/Users/noa/Workspace/lasso_positions_sampling_results/revision_files/gtr.tsv") %>% separate(dataset_id, "_supermatrices_",
                into = c("prefix", "last_value"), 
                remove = FALSE) %>% separate(last_value,"_",into = c("dataset_name", "suffix")) 
#%>%  select(-c("prefix","suffix"))
```

Compare to GTR, LG, JTT

```{r}
new_format_lasso_data %>% filter (actual_n_seq==30, actual_n_loci == 20000, actual_training_size ==4000) %>% group_by(actual_sample_pct, actual_training_size, actual_n_seq) %>% summarise (mean_r2 = mean(`lasso_test_R^2`), mean_spearman = mean(lasso_test_spearmanr)) 

jtt_data %>% group_by(actual_sample_pct, actual_training_size, actual_n_seq) %>% summarise (mean_r2 = mean(`lasso_test_R^2`), mean_spearman = mean(lasso_test_spearmanr)) 


lg_data %>% group_by(actual_sample_pct, actual_training_size, actual_n_seq) %>% summarise (mean_r2 = mean(`lasso_test_R^2`), mean_spearman = mean(lasso_test_spearmanr)) 


gtr_data %>% group_by(actual_sample_pct, actual_training_size, actual_n_seq) %>% summarise (mean_r2 = mean(`lasso_test_R^2`), mean_spearman = mean(lasso_test_spearmanr)) 


lasso_data_anova<- new_format_lasso_data %>% filter (actual_n_seq==30, actual_n_loci == 20000, actual_training_size ==4000) %>%   arrange(dataset_name,actual_sample_pct) %>% select (`lasso_test_R^2`)  %>% rename (accuracy_wag = `lasso_test_R^2` )
jtt_data_anova<- jtt_data %>% filter (actual_n_seq==30, actual_n_loci == 20000, actual_training_size ==4000) %>%   arrange(dataset_name,actual_sample_pct) %>% select (`lasso_test_R^2`)   %>% rename (accuracy_jtt = `lasso_test_R^2`)
lg_data_anova<- lg_data %>% filter (actual_n_seq==30, actual_n_loci == 20000, actual_training_size ==4000) %>% arrange(dataset_name,actual_sample_pct) %>% select (`lasso_test_R^2`)  %>% mutate (accuracy_lg = `lasso_test_R^2` ) 
gtr_data_anova<- gtr_data %>% filter (actual_n_seq==30, actual_n_loci == 20000, actual_training_size ==4000) %>% arrange(dataset_name,actual_sample_pct) %>%  select (`lasso_test_R^2`)  %>% mutate (accuracy_gtr = `lasso_test_R^2` ) 

total_protein_data<- cbind(lasso_data_anova,jtt_data_anova,lg_data_anova)
total_protein_data<- total_protein_data %>% mutate(wag_vs_jtt = abs(accuracy_wag-accuracy_jtt), wag_vs_lg = abs(accuracy_wag- accuracy_lg))



```

```{r}
wag<-new_format_lasso_data %>% filter (actual_n_seq==30, actual_n_loci == 20000, actual_training_size ==4000) %>%   arrange(dataset_name,actual_sample_pct) %>% select (dataset_name,actual_sample_pct, `lasso_test_R^2`)

jtt<- jtt_data %>% filter (actual_n_seq==30, actual_n_loci == 20000, actual_training_size ==4000) %>%   arrange(dataset_name,actual_sample_pct) %>% select (`lasso_test_R^2`)

lg<- jtt_data %>% filter (actual_n_seq==30, actual_n_loci == 20000, actual_training_size ==4000) %>%   arrange(dataset_name,actual_sample_pct) %>% select (`lasso_test_R^2`)

gtr<-gtr_data %>% filter (actual_n_seq==30, actual_n_loci == 20000, actual_training_size ==4000) %>%   arrange(dataset_name,actual_sample_pct) %>% select (dataset_name,actual_sample_pct, `lasso_test_R^2`)
gtr

```




Compare to naive 


```{r}


comp_data<-compare_to_naive_data %>% select (dataset_name,curr_msa_version_folder,actual_n_seq, actual_n_loci, actual_sample_pct, actual_training_size,`lasso_test_R^2`, `lasso_test_R^2_random`,`lasso_test_R^2_high_rate`, lasso_test_spearmanr, lasso_test_spearmanr_random, lasso_test_spearmanr_high_rate) %>% mutate (lasso_vs_random =`lasso_test_R^2`-`lasso_test_R^2_random`, lasso_vs_high_rate  =  `lasso_test_R^2`-`lasso_test_R^2_high_rate`, rel_lasso_vs_random =(`lasso_test_R^2`-`lasso_test_R^2_random`)/(1-`lasso_test_R^2`),rel_lasso_vs_high_rate =  (`lasso_test_R^2`-`lasso_test_R^2_high_rate`)/(1-`lasso_test_R^2`))                                                                                              

comp_data %>% group_by(actual_sample_pct,actual_training_size, actual_n_loci, actual_n_seq) %>% summarize (mean_random = mean(lasso_vs_random), mean_high_rate = mean(lasso_vs_high_rate))

```

```{r}
sup_6_data<-comp_data %>% select (dataset_name,actual_sample_pct,`lasso_test_R^2`, `lasso_test_R^2_random`,`lasso_test_R^2_high_rate`)
write.csv(sup_6_data, "/Users/noa/Workspace/lasso_positions_sampling_results/revision_files/Supp/Sup_6.csv")
```



```{r}
random<-comp_data %>% select(dataset_name, actual_sample_pct,acc = `lasso_test_R^2_random`) %>% mutate (type = "random")
lasso<-comp_data %>% select (dataset_name, actual_sample_pct,acc = `lasso_test_R^2`) %>% mutate (type = "lasso")
r_vs_l = rbind(random,lasso)

lme_l_vs_r = lme(log(acc/(1-acc)) ~ actual_sample_pct+as.factor(type), random = ~ 1 | dataset_name, data = r_vs_l)

summary(lme_l_vs_r)
print(rsq(lme_l_vs_r))
plot.lme((lme_l_vs_r))
#t.test(random, lasso)
```



```{r}
lm(lasso_vs_random ~ actual_sample_pct ,data = comp_data)

comp_data %>% ggplot(aes(x=actual_sample_pct, y =lasso_vs_random, color = dataset_name )) + geom_point()
```


Partial correlation

```{r}
library(ppcor)

NAGY_full<-c(-591292.121363, -587126.95115, -597938.413316, -570774.195266, -588753.835494, -569608.106342, -590716.345929, -591668.811842, -594525.038163, -598045.101842, -589717.874312, -595057.097224, -590297.409387, -586377.307642, -596103.557392, -593452.152343, -567489.973216, -593991.892143, -583194.48485, -587642.260039, -597040.217674, -584733.884527, -586765.996774, -599637.776061, -592276.587544, -590910.627913, -582963.724477, -591351.841294, -584573.031408, -595247.861237, -595386.722272, -588827.794294, -587576.700199, -593831.003821, -595365.367362, -582544.765864, -591460.440129, -594390.42714, -587643.041149, -592334.51493, -586475.367265, -592234.540207, -584734.671114, -575616.106332, -581677.482687, -589902.625408, -597980.834561, -589295.5717, -592566.050361, -596666.354365, -587173.077449, -591999.818082, -591657.905369, -580595.716722, -592690.690207, -595802.549339, -584900.466853, -588434.307398, -577002.615543, -588904.680456, -584373.961419, -598180.938378, -595255.690731, -596448.602945, -591195.90543, -596610.23622, -596655.065044, -589077.878234, -589974.488207, -591465.773323, -580035.091367, -595300.282798, -592820.334228, -588555.975554, -576065.008798, -594221.29815, -591693.542777, -589323.506463, -570827.492842, -597274.618611, -588741.1588, -591863.528498, -586601.236022, -596025.100353, -579450.427506, -578693.41493, -587218.655883, -572545.415867, -576870.24327, -581479.528153, -587129.208005, -592827.572661, -586979.581617, -593189.861354, -590075.383429, -594628.132387, -584632.030976, -588599.616248, -584480.928065, -596850.65396)
NAGY_lasso<- c (-587612.798018174, -583763.304299174, -593282.189179174, -568418.689840174, -585614.557932174, -567128.080383174, -587385.968850174, -587631.558506174, -590654.906817174, -593562.621504174, -586138.681338174, -591303.002105174, -585915.635298174, -582905.335871174, -591485.876485174, -590298.242614174, -564836.841460174, -590182.740862174, -579669.139224174, -583377.5362371741, -591667.629829174, -581033.635697174, -583127.395253174, -594127.721389174, -587886.167082174, -586535.581253174, -579853.794667174, -587386.434309174, -580523.379983174, -590563.436445174, -591594.845881174, -585988.622545174, -583905.8694991741, -589410.282388174, -590808.307814174, -579027.288375174, -588398.591252174, -590022.196215174, -583309.923501174, -588801.162033174, -583162.582670174, -588513.626365174, -580858.753899174, -571979.5875431739, -578580.584081174, -587070.923165174, -592842.026018174, -585616.814081174, -588544.140586174, -591855.285194174, -584895.8338151741, -588198.795653174, -587575.773328174, -578122.001894174, -589220.760264174, -591671.480698174, -581667.189846174, -585091.125658174, -572878.077261174, -585459.5060721741, -581223.434914174, -593218.002769174, -591395.503680174, -592604.402105174, -586846.6368971741, -592219.326616174, -592639.261284174, -585393.169819174, -587206.940776174, -587867.930037174, -577210.657844174, -591289.679699174, -588858.591110174, -585210.656431174, -573448.6009261741, -589796.592639174, -587900.195740174, -585621.283201174, -568663.922879174, -592786.118715174, -585974.440553174, -588582.594134174, -583332.392198174, -591560.681964174, -575857.910393174, -574860.213710174, -584381.255456174, -570265.335895174, -573510.720900174, -577779.809048174, -583805.000388174, -588683.551781174, -583584.665479174, -589026.534180174, -586050.171481174, -589651.046372174, -581033.703546174, -583980.396870174, -581222.086403174, -592539.224882174)
NAGY_high_rate <- c(-40245.810736, -40005.416865, -40661.870062, -39342.084671, -40073.140729, -39308.701496, -40319.431098, -40198.682792, -40363.636194, -40589.121647, -40157.590575, -40419.665351, -40104.39257, -39966.593747, -40572.294387, -40470.027603, -38970.000298, -40392.285219, -39850.666219, -40085.916177, -40601.011775, -39929.978599, -40153.033425, -40748.595522, -40190.811531, -40216.91497, -39715.250644, -40430.7041, -39977.495549, -40646.00105, -40483.156105, -40001.498619, -39943.73812, -40489.610294, -40487.34372, -39670.530251, -40305.30852, -40462.746353, -40028.721528, -40039.414938, -40193.903511, -40249.169923, -39974.03522, -39379.36647, -39673.038018, -40287.879725, -40525.91791, -40198.212028, -40328.842109, -40561.494872, -40101.869126, -40283.00928, -40243.955847, -39912.95163, -40387.500111, -40525.387321, -39674.423557, -40086.771364, -39405.613475, -40245.247174, -40135.806895, -40665.886543, -40424.098067, -40544.25082, -40338.188912, -40632.335823, -40544.301582, -40128.866072, -40225.496345, -40145.657822, -39647.328638, -40522.844767, -40282.116954, -40114.174893, -39511.319828, -40419.480862, -40430.879467, -40120.868727, -39270.613989, -40666.490736, -40134.043743, -40273.624352, -39855.779415, -40578.821826, -39726.783355, -39423.133892, -40159.021947, -39387.80277, -39454.933078, -39552.964328, -40003.271268, -40457.429898, -40031.854959, -40417.799591, -40026.831159, -40506.912007, -40084.554109, -40054.459122, -39997.816265, -40546.746516)

data<- data.frame(NAGY_full,NAGY_lasso,NAGY_high_rate)
pcor(data)

```
```{r}
library(ppcor)
YANG_lasso<-c(-386593.4152361294, -374602.01337012945, -385229.4003141294, -383374.12089512945, -386139.51596912945, -382286.25391912943, -387083.67107412947, -382017.76096312946, -380828.4967541295, -388064.05394412944, -386880.40261612943, -380410.64668812946, -387416.4039601294, -379933.09482112946, -382275.6634381295, -381187.1072081294, -382594.50935712946, -382492.5892811294, -375870.0241141294, -387361.67579012946, -385237.9311741294, -386735.21330912947, -386271.2635421294, -384180.91413712944, -382014.47778712946, -387938.43194812944, -384675.67896012944, -386761.21469112945, -383461.43330512947, -387577.79059312947, -384858.06081712944, -385833.27115112945, -382474.2756351294, -386647.6954761294, -388215.51576812944, -381470.84730312944, -385564.0174181294, -388493.54150712944, -388122.3496011294, -386258.76274412946, -387438.25623112946, -383128.82874212944, -384615.8658911294, -383520.3357581294, -383699.2464491294, -385034.43612412945, -380974.42897512944, -382664.92386712943, -370209.3281121295, -383838.96973512945, -378962.0404641295, -386546.88576512947, -385523.46857212944, -381557.6390611294, -385401.50868512946, -380558.29876212945, -387648.1922961294, -385056.63185912947, -382150.84049312945, -384779.5688171295, -387291.7702151294, -386568.9458281294, -386957.89251512947, -387459.63219412946, -386253.66047712945, -387809.54191312945, -386990.29260112945, -383543.51791912946, -375537.54342012946, -387731.2012931295, -380784.5248481294, -377508.2474351294, -379696.35902112944, -383277.82862412947, -381750.33778912947, -386857.8923791294, -387221.65673012944, -386733.35156312946, -387550.21096712945, -384816.52159712947, -382159.48027612944, -376673.6756921295, -387169.3519101294, -385452.3385701295, -383203.37759812945, -381029.92748812947, -386289.3904991294, -384884.66852112947, -385341.37235312944, -377506.70044812944, -378769.70193412947, -386674.83279012947, -380701.47663612943, -385108.49517712946, -375980.3430281294, -386677.49950412946, -384112.6893081294, -386251.27808712947, -382725.91634212947, -387260.82844512945)
YANG_high_rate<- c(-29040.90838, -28111.184498, -28787.829851, -28699.638778, -28952.411853, -28531.552055, -29045.41455, -28731.989047, -28445.400433, -29133.548953, -29017.001415, -28638.105967, -29067.967369, -28361.87458, -28830.273665, -28570.78539, -28771.050047, -28740.138424, -28362.910327, -29096.486898, -29077.611749, -29048.528967, -28962.004488, -28826.853156, -28600.844033, -29196.992994, -28646.726527, -28892.204485, -28874.411448, -29153.590757, -28816.160782, -28859.350594, -28583.269013, -29056.747184, -29147.160608, -28380.945338, -28920.601113, -29127.231978, -29087.812994, -28849.731821, -29096.660905, -28829.928173, -29001.072752, -28667.909848, -28650.21345, -28941.810264, -28813.669327, -28683.316031, -27783.957299, -28669.196052, -28492.303159, -28942.592039, -28803.640749, -28719.116042, -28717.987769, -28545.396978, -29179.013442, -28810.638568, -28718.472625, -28765.870495, -29025.13709, -29011.629787, -29075.635561, -29043.072525, -29053.268095, -29031.7203, -29055.938273, -28731.061886, -28026.937257, -29113.136317, -28375.852279, -27895.247025, -28625.009074, -28685.156463, -28572.621493, -29006.866901, -29013.495363, -28822.061111, -29101.003401, -28787.258228, -28487.962619, -27949.72672, -29138.354081, -28891.919068, -28507.522432, -28468.779418, -28993.512686, -28853.320735, -28841.888347, -28313.793571, -28232.12387, -29004.261844, -28399.786452, -28858.461567, -28138.442703, -28993.766876, -28854.163893, -28916.745598, -28723.102073, -29021.400051)
YANG_full<- c(-388460.242394, -375803.250369, -386665.076234, -385091.201513, -387866.073843, -383077.3516, -388735.76436, -383118.45632, -382592.627784, -389907.801541, -388351.595439, -382774.992928, -389752.544148, -380944.809649, -383789.849726, -382435.323191, -383797.338865, -383719.91215, -377309.107351, -389286.278332, -387411.85486, -388975.836207, -387820.648943, -385482.747948, -383500.893607, -390016.384361, -386369.158462, -388457.478953, -385025.46683, -389866.947404, -385916.564403, -388045.702309, -384004.527933, -388364.661634, -390191.771233, -382709.924815, -387422.140095, -390688.582562, -390626.315811, -387924.493135, -389132.225873, -385383.578979, -387164.928568, -384949.622134, -384700.30079, -386529.144229, -383369.4333, -384534.791504, -371649.998024, -384404.8559, -380668.904154, -388693.676327, -386758.783133, -383305.944165, -387453.876506, -381779.092093, -390118.789475, -386428.2382, -383555.914433, -385516.324114, -389312.546938, -388386.036044, -388646.182407, -389271.768785, -388166.110706, -389718.151311, -388589.350938, -384600.49616, -376539.356808, -389818.08076, -381603.000396, -378520.653854, -381204.052738, -384765.50574, -383156.092743, -388653.035686, -389596.836885, -387864.001008, -389793.695322, -385978.336929, -383461.565032, -377317.776718, -389257.110871, -386944.261443, -384196.574652, -382644.404126, -388163.295975, -386596.915636, -386605.085608, -377918.881332, -380039.750776, -388646.588194, -381659.366832, -386582.302754, -376394.565013, -388453.460105, -385246.076499, -387942.186334, -384338.950537, -388449.019042)

data<- data.frame(YANG_full,YANG_lasso,YANG_high_rate)
pcor(data)
```

```{r}
PRUM_full<- c(-139824.983671, -139395.777826, -139507.805695, -140499.64602, -140507.211651, -140070.58312, -140464.437925, -140144.839286, -140127.286518, -138626.702272, -140211.848278, -139580.350651, -140518.925326, -139650.73905, -140569.331587, -140439.794681, -140350.021823, -140402.772466, -139895.512342, -140530.759044, -140165.511162, -139990.646571, -140156.436867, -139335.956858, -140028.98503, -140531.926399, -139617.407949, -139192.654404, -139107.065573, -138435.003307, -140435.021349, -138930.666291, -139272.24307, -140116.360261, -140377.039292, -140213.482183, -140581.055562, -140483.778596, -140362.107655, -140542.641552, -140509.06807, -139709.707638, -139324.741811, -139073.972847, -138846.391427, -140524.135816, -140173.911287, -139932.5777, -140247.465799, -140538.835285, -140049.085856, -140453.78725, -140314.577062, -140450.003296, -140488.492166, -138032.102811, -140421.150817, -140364.618511, -140478.739457, -139613.151289, -138888.304212, -139845.828034, -139572.943337, -140459.999651, -140557.541632, -140115.540186, -140492.654935, -140576.128388, -139545.38846, -140152.898094, -139772.628171, -140385.182615, -140540.376367, -140468.108822, -140474.158321, -138080.995019, -140430.451016, -140584.296314, -139429.706361, -140586.685194, -140455.73631, -139388.50743, -140094.592105, -140327.152193, -140375.192304, -137543.556033, -140490.591742, -140094.209041, -139973.341439, -140247.785528, -139709.743283, -140380.389611, -140030.720801, -139102.435017, -140119.602059, -137978.713177, -140546.26294, -140209.846778, -139693.702659, -140248.381873)
PRUM_lasso<- c(-120754.7585252262, -119825.7701542262, -119890.4161852262, -121039.2155972262, -121052.7330842262, -120829.69865922621, -121185.5872832262, -120835.49841222621, -120776.2286352262, -119211.2910552262, -120928.04598022619, -120264.00755122621, -121263.2511092262, -120160.12763322619, -121344.98677022621, -120974.79192822619, -121044.6351952262, -121000.05542022621, -120672.4813802262, -121259.1976372262, -120992.33648622621, -120676.8397412262, -120828.6429192262, -119842.7811632262, -120594.6094832262, -121105.0700462262, -120252.4811762262, -119836.3403182262, -119708.30634622619, -119263.5090552262, -121080.4889212262, -119391.29550622619, -119875.2078262262, -120756.95396422621, -121045.4838222262, -120772.01677422621, -121109.3005652262, -121226.01818922619, -121101.1153312262, -121252.10582622621, -121095.40606522621, -120301.8080332262, -120026.4724932262, -119853.53532422619, -119446.72898922619, -121186.6158772262, -120859.4840362262, -120804.81323222621, -121059.9194632262, -121083.8737322262, -120673.85422222619, -121213.08803522619, -120675.5454532262, -121131.48547022621, -121255.1926462262, -119155.7638282262, -121040.21732422619, -121067.34027522619, -121209.6135222262, -120312.44269722619, -119570.70159922619, -120556.19585422621, -120137.5932762262, -120767.08958622621, -121407.0155422262, -120906.7238842262, -121204.6679012262, -121310.0896962262, -120128.05554322619, -120963.49925422619, -120508.4269902262, -120860.35847622619, -121265.1660822262, -121157.5433972262, -121241.66036122621, -118701.3698972262, -121237.43206422619, -121305.1623592262, -119941.25103522619, -121298.64310022621, -121263.6385772262, -120122.83510722619, -120479.95200022621, -120850.79780222621, -120651.8457032262, -118004.7111122262, -121122.52507922621, -120782.9465662262, -120636.8380562262, -120760.7317802262, -120244.78925322619, -121055.8234702262, -120717.34377522621, -119677.3670702262, -120713.68480022621, -118605.0797222262, -121322.5594052262, -120596.88017822619, -120304.09866722621, -120797.9527172262)
PRUM_high_rate<- c(-44408.070412, -44318.679212, -44300.195537, -44645.467471, -44677.287321, -44580.870788, -44728.566465, -44584.969805, -44611.995579, -44109.648645, -44643.8749, -44418.225447, -44739.219475, -44410.165145, -44737.311826, -44659.818135, -44564.641412, -44607.739565, -44458.463593, -44684.249848, -44585.413562, -44554.896139, -44590.180618, -44338.160601, -44438.566703, -44722.773317, -44322.906089, -44229.163141, -44222.412478, -43976.8144, -44670.323254, -44143.157513, -44314.995818, -44541.551979, -44628.170773, -44546.407705, -44737.119489, -44709.443624, -44640.846053, -44712.880303, -44681.471885, -44411.5041, -44281.434349, -44210.208145, -44180.506491, -44714.94815, -44488.487697, -44487.137939, -44622.797824, -44745.919448, -44511.100697, -44703.923162, -44568.682278, -44678.940125, -44693.420865, -43850.924057, -44689.548558, -44627.052364, -44656.971148, -44359.755468, -44154.853933, -44495.459645, -44382.205254, -44692.56783, -44734.979128, -44578.659361, -44719.30651, -44754.392762, -44324.286662, -44530.206089, -44470.343814, -44681.338245, -44726.065802, -44679.023967, -44711.679241, -43894.180573, -44667.660762, -44750.719334, -44331.759854, -44748.000594, -44710.191296, -44240.303888, -44594.89433, -44633.713739, -44652.17303, -43709.043562, -44672.02531, -44602.304511, -44452.051838, -44601.562154, -44472.653978, -44655.294248, -44549.526673, -44217.035836, -44598.003186, -43861.001615, -44713.827375, -44594.09429, -44403.122906, -44538.810781)

data<- data.frame(PRUM_full,PRUM_lasso,PRUM_high_rate)
pcor(data)
```


Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file). 

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.

